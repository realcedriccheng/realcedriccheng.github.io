<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="YCSB 是一个评估数据库性能的测试框架，可以测试不同数据库在不同负载的表现。\n搭建自定义负载 一个工作负载定义了加载到数据库中的数据集（data set）和操作数据库的事务集（transaction set）。\n"><title>修改YCSB负载测试自定义数据集</title><link rel=canonical href=https://realcedriccheng.github.io/p/ycsb_customize/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="修改YCSB负载测试自定义数据集"><meta property='og:description' content="YCSB 是一个评估数据库性能的测试框架，可以测试不同数据库在不同负载的表现。\n搭建自定义负载 一个工作负载定义了加载到数据库中的数据集（data set）和操作数据库的事务集（transaction set）。\n"><meta property='og:url' content='https://realcedriccheng.github.io/p/ycsb_customize/'><meta property='og:site_name' content='The Orange Flavored Whisper'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='操作系统'><meta property='article:tag' content='数据库'><meta property='article:tag' content='YCSB'><meta property='article:published_time' content='2024-12-30T00:00:00+00:00'><meta property='article:modified_time' content='2024-12-30T00:00:00+00:00'><meta name=twitter:title content="修改YCSB负载测试自定义数据集"><meta name=twitter:description content="YCSB 是一个评估数据库性能的测试框架，可以测试不同数据库在不同负载的表现。\n搭建自定义负载 一个工作负载定义了加载到数据库中的数据集（data set）和操作数据库的事务集（transaction set）。\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_5b3a75c4f0fbbc6c.jfif width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🍊</span></figure><div class=site-meta><h1 class=site-name><a href=/>The Orange Flavored Whisper</a></h1><h2 class=site-description>on tech notes</h2></div></header><ol class=menu-social><li><a href=https://github.com/realcedriccheng/ target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/cu/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-lemon"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17.536 3.393c3.905 3.906 3.905 10.237.0 14.143-3.906 3.905-10.237 3.905-14.143.0L17.536 3.393"/><path d="M5.868 15.06a6.5 6.5.0 009.193-9.192"/><path d="M10.464 10.464l4.597 4.597"/><path d="M10.464 10.464v6.364"/><path d="M10.464 10.464h6.364"/></svg>
<span>Cedric Update</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#搭建自定义负载>搭建自定义负载</a></li><li><a href=#编译-ycsb>编译 YCSB</a></li><li><a href=#参考资料>参考资料</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/>技术分析
</a><a href=/categories/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/>测试工具</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/ycsb_customize/>修改YCSB负载测试自定义数据集</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Dec 30, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>13 minute read</time></div></footer></div></header><section class=article-content><p>YCSB 是一个评估数据库性能的测试框架，可以测试不同数据库在不同负载的表现。</p><h2 id=搭建自定义负载>搭建自定义负载</h2><p>一个工作负载定义了加载到数据库中的数据集（data set）和操作数据库的事务集（transaction set）。</p><p>一个工作负载包括 2 个文件：</p><ul><li>一个用于生成数据记录和事务操作的 JAVA 类</li><li>一个用于调整负载特性（如读写比例）的参数文件</li></ul><p>YCSB 默认只能使用随机生成的数据集，为了使用自定义数据集，可以自己实现一个 workload。下面是根据 CoreWorkload 修改的 MyWorkload. java。将其放在 YCSB/core/src/main/java/site/ycsb/workloads/目录下一起编译。</p><p>修改内容主要是：将原来随机生成 value 的部分改为从文件读取指定长度的字符串。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span><span class=lnt>361
</span><span class=lnt>362
</span><span class=lnt>363
</span><span class=lnt>364
</span><span class=lnt>365
</span><span class=lnt>366
</span><span class=lnt>367
</span><span class=lnt>368
</span><span class=lnt>369
</span><span class=lnt>370
</span><span class=lnt>371
</span><span class=lnt>372
</span><span class=lnt>373
</span><span class=lnt>374
</span><span class=lnt>375
</span><span class=lnt>376
</span><span class=lnt>377
</span><span class=lnt>378
</span><span class=lnt>379
</span><span class=lnt>380
</span><span class=lnt>381
</span><span class=lnt>382
</span><span class=lnt>383
</span><span class=lnt>384
</span><span class=lnt>385
</span><span class=lnt>386
</span><span class=lnt>387
</span><span class=lnt>388
</span><span class=lnt>389
</span><span class=lnt>390
</span><span class=lnt>391
</span><span class=lnt>392
</span><span class=lnt>393
</span><span class=lnt>394
</span><span class=lnt>395
</span><span class=lnt>396
</span><span class=lnt>397
</span><span class=lnt>398
</span><span class=lnt>399
</span><span class=lnt>400
</span><span class=lnt>401
</span><span class=lnt>402
</span><span class=lnt>403
</span><span class=lnt>404
</span><span class=lnt>405
</span><span class=lnt>406
</span><span class=lnt>407
</span><span class=lnt>408
</span><span class=lnt>409
</span><span class=lnt>410
</span><span class=lnt>411
</span><span class=lnt>412
</span><span class=lnt>413
</span><span class=lnt>414
</span><span class=lnt>415
</span><span class=lnt>416
</span><span class=lnt>417
</span><span class=lnt>418
</span><span class=lnt>419
</span><span class=lnt>420
</span><span class=lnt>421
</span><span class=lnt>422
</span><span class=lnt>423
</span><span class=lnt>424
</span><span class=lnt>425
</span><span class=lnt>426
</span><span class=lnt>427
</span><span class=lnt>428
</span><span class=lnt>429
</span><span class=lnt>430
</span><span class=lnt>431
</span><span class=lnt>432
</span><span class=lnt>433
</span><span class=lnt>434
</span><span class=lnt>435
</span><span class=lnt>436
</span><span class=lnt>437
</span><span class=lnt>438
</span><span class=lnt>439
</span><span class=lnt>440
</span><span class=lnt>441
</span><span class=lnt>442
</span><span class=lnt>443
</span><span class=lnt>444
</span><span class=lnt>445
</span><span class=lnt>446
</span><span class=lnt>447
</span><span class=lnt>448
</span><span class=lnt>449
</span><span class=lnt>450
</span><span class=lnt>451
</span><span class=lnt>452
</span><span class=lnt>453
</span><span class=lnt>454
</span><span class=lnt>455
</span><span class=lnt>456
</span><span class=lnt>457
</span><span class=lnt>458
</span><span class=lnt>459
</span><span class=lnt>460
</span><span class=lnt>461
</span><span class=lnt>462
</span><span class=lnt>463
</span><span class=lnt>464
</span><span class=lnt>465
</span><span class=lnt>466
</span><span class=lnt>467
</span><span class=lnt>468
</span><span class=lnt>469
</span><span class=lnt>470
</span><span class=lnt>471
</span><span class=lnt>472
</span><span class=lnt>473
</span><span class=lnt>474
</span><span class=lnt>475
</span><span class=lnt>476
</span><span class=lnt>477
</span><span class=lnt>478
</span><span class=lnt>479
</span><span class=lnt>480
</span><span class=lnt>481
</span><span class=lnt>482
</span><span class=lnt>483
</span><span class=lnt>484
</span><span class=lnt>485
</span><span class=lnt>486
</span><span class=lnt>487
</span><span class=lnt>488
</span><span class=lnt>489
</span><span class=lnt>490
</span><span class=lnt>491
</span><span class=lnt>492
</span><span class=lnt>493
</span><span class=lnt>494
</span><span class=lnt>495
</span><span class=lnt>496
</span><span class=lnt>497
</span><span class=lnt>498
</span><span class=lnt>499
</span><span class=lnt>500
</span><span class=lnt>501
</span><span class=lnt>502
</span><span class=lnt>503
</span><span class=lnt>504
</span><span class=lnt>505
</span><span class=lnt>506
</span><span class=lnt>507
</span><span class=lnt>508
</span><span class=lnt>509
</span><span class=lnt>510
</span><span class=lnt>511
</span><span class=lnt>512
</span><span class=lnt>513
</span><span class=lnt>514
</span><span class=lnt>515
</span><span class=lnt>516
</span><span class=lnt>517
</span><span class=lnt>518
</span><span class=lnt>519
</span><span class=lnt>520
</span><span class=lnt>521
</span><span class=lnt>522
</span><span class=lnt>523
</span><span class=lnt>524
</span><span class=lnt>525
</span><span class=lnt>526
</span><span class=lnt>527
</span><span class=lnt>528
</span><span class=lnt>529
</span><span class=lnt>530
</span><span class=lnt>531
</span><span class=lnt>532
</span><span class=lnt>533
</span><span class=lnt>534
</span><span class=lnt>535
</span><span class=lnt>536
</span><span class=lnt>537
</span><span class=lnt>538
</span><span class=lnt>539
</span><span class=lnt>540
</span><span class=lnt>541
</span><span class=lnt>542
</span><span class=lnt>543
</span><span class=lnt>544
</span><span class=lnt>545
</span><span class=lnt>546
</span><span class=lnt>547
</span><span class=lnt>548
</span><span class=lnt>549
</span><span class=lnt>550
</span><span class=lnt>551
</span><span class=lnt>552
</span><span class=lnt>553
</span><span class=lnt>554
</span><span class=lnt>555
</span><span class=lnt>556
</span><span class=lnt>557
</span><span class=lnt>558
</span><span class=lnt>559
</span><span class=lnt>560
</span><span class=lnt>561
</span><span class=lnt>562
</span><span class=lnt>563
</span><span class=lnt>564
</span><span class=lnt>565
</span><span class=lnt>566
</span><span class=lnt>567
</span><span class=lnt>568
</span><span class=lnt>569
</span><span class=lnt>570
</span><span class=lnt>571
</span><span class=lnt>572
</span><span class=lnt>573
</span><span class=lnt>574
</span><span class=lnt>575
</span><span class=lnt>576
</span><span class=lnt>577
</span><span class=lnt>578
</span><span class=lnt>579
</span><span class=lnt>580
</span><span class=lnt>581
</span><span class=lnt>582
</span><span class=lnt>583
</span><span class=lnt>584
</span><span class=lnt>585
</span><span class=lnt>586
</span><span class=lnt>587
</span><span class=lnt>588
</span><span class=lnt>589
</span><span class=lnt>590
</span><span class=lnt>591
</span><span class=lnt>592
</span><span class=lnt>593
</span><span class=lnt>594
</span><span class=lnt>595
</span><span class=lnt>596
</span><span class=lnt>597
</span><span class=lnt>598
</span><span class=lnt>599
</span><span class=lnt>600
</span><span class=lnt>601
</span><span class=lnt>602
</span><span class=lnt>603
</span><span class=lnt>604
</span><span class=lnt>605
</span><span class=lnt>606
</span><span class=lnt>607
</span><span class=lnt>608
</span><span class=lnt>609
</span><span class=lnt>610
</span><span class=lnt>611
</span><span class=lnt>612
</span><span class=lnt>613
</span><span class=lnt>614
</span><span class=lnt>615
</span><span class=lnt>616
</span><span class=lnt>617
</span><span class=lnt>618
</span><span class=lnt>619
</span><span class=lnt>620
</span><span class=lnt>621
</span><span class=lnt>622
</span><span class=lnt>623
</span><span class=lnt>624
</span><span class=lnt>625
</span><span class=lnt>626
</span><span class=lnt>627
</span><span class=lnt>628
</span><span class=lnt>629
</span><span class=lnt>630
</span><span class=lnt>631
</span><span class=lnt>632
</span><span class=lnt>633
</span><span class=lnt>634
</span><span class=lnt>635
</span><span class=lnt>636
</span><span class=lnt>637
</span><span class=lnt>638
</span><span class=lnt>639
</span><span class=lnt>640
</span><span class=lnt>641
</span><span class=lnt>642
</span><span class=lnt>643
</span><span class=lnt>644
</span><span class=lnt>645
</span><span class=lnt>646
</span><span class=lnt>647
</span><span class=lnt>648
</span><span class=lnt>649
</span><span class=lnt>650
</span><span class=lnt>651
</span><span class=lnt>652
</span><span class=lnt>653
</span><span class=lnt>654
</span><span class=lnt>655
</span><span class=lnt>656
</span><span class=lnt>657
</span><span class=lnt>658
</span><span class=lnt>659
</span><span class=lnt>660
</span><span class=lnt>661
</span><span class=lnt>662
</span><span class=lnt>663
</span><span class=lnt>664
</span><span class=lnt>665
</span><span class=lnt>666
</span><span class=lnt>667
</span><span class=lnt>668
</span><span class=lnt>669
</span><span class=lnt>670
</span><span class=lnt>671
</span><span class=lnt>672
</span><span class=lnt>673
</span><span class=lnt>674
</span><span class=lnt>675
</span><span class=lnt>676
</span><span class=lnt>677
</span><span class=lnt>678
</span><span class=lnt>679
</span><span class=lnt>680
</span><span class=lnt>681
</span><span class=lnt>682
</span><span class=lnt>683
</span><span class=lnt>684
</span><span class=lnt>685
</span><span class=lnt>686
</span><span class=lnt>687
</span><span class=lnt>688
</span><span class=lnt>689
</span><span class=lnt>690
</span><span class=lnt>691
</span><span class=lnt>692
</span><span class=lnt>693
</span><span class=lnt>694
</span><span class=lnt>695
</span><span class=lnt>696
</span><span class=lnt>697
</span><span class=lnt>698
</span><span class=lnt>699
</span><span class=lnt>700
</span><span class=lnt>701
</span><span class=lnt>702
</span><span class=lnt>703
</span><span class=lnt>704
</span><span class=lnt>705
</span><span class=lnt>706
</span><span class=lnt>707
</span><span class=lnt>708
</span><span class=lnt>709
</span><span class=lnt>710
</span><span class=lnt>711
</span><span class=lnt>712
</span><span class=lnt>713
</span><span class=lnt>714
</span><span class=lnt>715
</span><span class=lnt>716
</span><span class=lnt>717
</span><span class=lnt>718
</span><span class=lnt>719
</span><span class=lnt>720
</span><span class=lnt>721
</span><span class=lnt>722
</span><span class=lnt>723
</span><span class=lnt>724
</span><span class=lnt>725
</span><span class=lnt>726
</span><span class=lnt>727
</span><span class=lnt>728
</span><span class=lnt>729
</span><span class=lnt>730
</span><span class=lnt>731
</span><span class=lnt>732
</span><span class=lnt>733
</span><span class=lnt>734
</span><span class=lnt>735
</span><span class=lnt>736
</span><span class=lnt>737
</span><span class=lnt>738
</span><span class=lnt>739
</span><span class=lnt>740
</span><span class=lnt>741
</span><span class=lnt>742
</span><span class=lnt>743
</span><span class=lnt>744
</span><span class=lnt>745
</span><span class=lnt>746
</span><span class=lnt>747
</span><span class=lnt>748
</span><span class=lnt>749
</span><span class=lnt>750
</span><span class=lnt>751
</span><span class=lnt>752
</span><span class=lnt>753
</span><span class=lnt>754
</span><span class=lnt>755
</span><span class=lnt>756
</span><span class=lnt>757
</span><span class=lnt>758
</span><span class=lnt>759
</span><span class=lnt>760
</span><span class=lnt>761
</span><span class=lnt>762
</span><span class=lnt>763
</span><span class=lnt>764
</span><span class=lnt>765
</span><span class=lnt>766
</span><span class=lnt>767
</span><span class=lnt>768
</span><span class=lnt>769
</span><span class=lnt>770
</span><span class=lnt>771
</span><span class=lnt>772
</span><span class=lnt>773
</span><span class=lnt>774
</span><span class=lnt>775
</span><span class=lnt>776
</span><span class=lnt>777
</span><span class=lnt>778
</span><span class=lnt>779
</span><span class=lnt>780
</span><span class=lnt>781
</span><span class=lnt>782
</span><span class=lnt>783
</span><span class=lnt>784
</span><span class=lnt>785
</span><span class=lnt>786
</span><span class=lnt>787
</span><span class=lnt>788
</span><span class=lnt>789
</span><span class=lnt>790
</span><span class=lnt>791
</span><span class=lnt>792
</span><span class=lnt>793
</span><span class=lnt>794
</span><span class=lnt>795
</span><span class=lnt>796
</span><span class=lnt>797
</span><span class=lnt>798
</span><span class=lnt>799
</span><span class=lnt>800
</span><span class=lnt>801
</span><span class=lnt>802
</span><span class=lnt>803
</span><span class=lnt>804
</span><span class=lnt>805
</span><span class=lnt>806
</span><span class=lnt>807
</span><span class=lnt>808
</span><span class=lnt>809
</span><span class=lnt>810
</span><span class=lnt>811
</span><span class=lnt>812
</span><span class=lnt>813
</span><span class=lnt>814
</span><span class=lnt>815
</span><span class=lnt>816
</span><span class=lnt>817
</span><span class=lnt>818
</span><span class=lnt>819
</span><span class=lnt>820
</span><span class=lnt>821
</span><span class=lnt>822
</span><span class=lnt>823
</span><span class=lnt>824
</span><span class=lnt>825
</span><span class=lnt>826
</span><span class=lnt>827
</span><span class=lnt>828
</span><span class=lnt>829
</span><span class=lnt>830
</span><span class=lnt>831
</span><span class=lnt>832
</span><span class=lnt>833
</span><span class=lnt>834
</span><span class=lnt>835
</span><span class=lnt>836
</span><span class=lnt>837
</span><span class=lnt>838
</span><span class=lnt>839
</span><span class=lnt>840
</span><span class=lnt>841
</span><span class=lnt>842
</span><span class=lnt>843
</span><span class=lnt>844
</span><span class=lnt>845
</span><span class=lnt>846
</span><span class=lnt>847
</span><span class=lnt>848
</span><span class=lnt>849
</span><span class=lnt>850
</span><span class=lnt>851
</span><span class=lnt>852
</span><span class=lnt>853
</span><span class=lnt>854
</span><span class=lnt>855
</span><span class=lnt>856
</span><span class=lnt>857
</span><span class=lnt>858
</span><span class=lnt>859
</span><span class=lnt>860
</span><span class=lnt>861
</span><span class=lnt>862
</span><span class=lnt>863
</span><span class=lnt>864
</span><span class=lnt>865
</span><span class=lnt>866
</span><span class=lnt>867
</span><span class=lnt>868
</span><span class=lnt>869
</span><span class=lnt>870
</span><span class=lnt>871
</span><span class=lnt>872
</span><span class=lnt>873
</span><span class=lnt>874
</span><span class=lnt>875
</span><span class=lnt>876
</span><span class=lnt>877
</span><span class=lnt>878
</span><span class=lnt>879
</span><span class=lnt>880
</span><span class=lnt>881
</span><span class=lnt>882
</span><span class=lnt>883
</span><span class=lnt>884
</span><span class=lnt>885
</span><span class=lnt>886
</span><span class=lnt>887
</span><span class=lnt>888
</span><span class=lnt>889
</span><span class=lnt>890
</span><span class=lnt>891
</span><span class=lnt>892
</span><span class=lnt>893
</span><span class=lnt>894
</span><span class=lnt>895
</span><span class=lnt>896
</span><span class=lnt>897
</span><span class=lnt>898
</span><span class=lnt>899
</span><span class=lnt>900
</span><span class=lnt>901
</span><span class=lnt>902
</span><span class=lnt>903
</span><span class=lnt>904
</span><span class=lnt>905
</span><span class=lnt>906
</span><span class=lnt>907
</span><span class=lnt>908
</span><span class=lnt>909
</span><span class=lnt>910
</span><span class=lnt>911
</span><span class=lnt>912
</span><span class=lnt>913
</span><span class=lnt>914
</span><span class=lnt>915
</span><span class=lnt>916
</span><span class=lnt>917
</span><span class=lnt>918
</span><span class=lnt>919
</span><span class=lnt>920
</span><span class=lnt>921
</span><span class=lnt>922
</span><span class=lnt>923
</span><span class=lnt>924
</span><span class=lnt>925
</span><span class=lnt>926
</span><span class=lnt>927
</span><span class=lnt>928
</span><span class=lnt>929
</span><span class=lnt>930
</span><span class=lnt>931
</span><span class=lnt>932
</span><span class=lnt>933
</span><span class=lnt>934
</span><span class=lnt>935
</span><span class=lnt>936
</span><span class=lnt>937
</span><span class=lnt>938
</span><span class=lnt>939
</span><span class=lnt>940
</span><span class=lnt>941
</span><span class=lnt>942
</span><span class=lnt>943
</span><span class=lnt>944
</span><span class=lnt>945
</span><span class=lnt>946
</span><span class=lnt>947
</span><span class=lnt>948
</span><span class=lnt>949
</span><span class=lnt>950
</span><span class=lnt>951
</span><span class=lnt>952
</span><span class=lnt>953
</span><span class=lnt>954
</span><span class=lnt>955
</span><span class=lnt>956
</span><span class=lnt>957
</span><span class=lnt>958
</span><span class=lnt>959
</span><span class=lnt>960
</span><span class=lnt>961
</span><span class=lnt>962
</span><span class=lnt>963
</span><span class=lnt>964
</span><span class=lnt>965
</span><span class=lnt>966
</span><span class=lnt>967
</span><span class=lnt>968
</span><span class=lnt>969
</span><span class=lnt>970
</span><span class=lnt>971
</span><span class=lnt>972
</span><span class=lnt>973
</span><span class=lnt>974
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>/**</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Copyright</span> <span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=mi>2010</span> <span class=n>Yahoo</span><span class=o>!</span> <span class=n>Inc</span><span class=o>.</span><span class=p>,</span> <span class=n>Copyright</span> <span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=mi>2016</span><span class=o>-</span><span class=mi>2020</span> <span class=n>YCSB</span> <span class=n>contributors</span><span class=o>.</span> <span class=n>All</span> <span class=n>rights</span> <span class=n>reserved</span><span class=o>.</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Licensed</span> <span class=n>under</span> <span class=n>the</span> <span class=n>Apache</span> <span class=n>License</span><span class=p>,</span> <span class=n>Version</span> <span class=mf>2.0</span> <span class=p>(</span><span class=n>the</span> <span class=s2>&#34;License&#34;</span><span class=p>);</span> <span class=n>you</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>may</span> <span class=ow>not</span> <span class=n>use</span> <span class=n>this</span> <span class=n>file</span> <span class=n>except</span> <span class=ow>in</span> <span class=n>compliance</span> <span class=n>with</span> <span class=n>the</span> <span class=n>License</span><span class=o>.</span> <span class=n>You</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>may</span> <span class=n>obtain</span> <span class=n>a</span> <span class=n>copy</span> <span class=n>of</span> <span class=n>the</span> <span class=n>License</span> <span class=n>at</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>http</span><span class=p>:</span><span class=o>//</span><span class=n>www</span><span class=o>.</span><span class=n>apache</span><span class=o>.</span><span class=n>org</span><span class=o>/</span><span class=n>licenses</span><span class=o>/</span><span class=n>LICENSE</span><span class=o>-</span><span class=mf>2.0</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>Unless</span> <span class=n>required</span> <span class=n>by</span> <span class=n>applicable</span> <span class=n>law</span> <span class=ow>or</span> <span class=n>agreed</span> <span class=n>to</span> <span class=ow>in</span> <span class=n>writing</span><span class=p>,</span> <span class=n>software</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>distributed</span> <span class=n>under</span> <span class=n>the</span> <span class=n>License</span> <span class=n>is</span> <span class=n>distributed</span> <span class=n>on</span> <span class=n>an</span> <span class=s2>&#34;AS IS&#34;</span> <span class=n>BASIS</span><span class=p>,</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>WITHOUT</span> <span class=n>WARRANTIES</span> <span class=n>OR</span> <span class=n>CONDITIONS</span> <span class=n>OF</span> <span class=n>ANY</span> <span class=n>KIND</span><span class=p>,</span> <span class=n>either</span> <span class=n>express</span> <span class=ow>or</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>implied</span><span class=o>.</span> <span class=n>See</span> <span class=n>the</span> <span class=n>License</span> <span class=k>for</span> <span class=n>the</span> <span class=n>specific</span> <span class=n>language</span> <span class=n>governing</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>permissions</span> <span class=ow>and</span> <span class=n>limitations</span> <span class=n>under</span> <span class=n>the</span> <span class=n>License</span><span class=o>.</span> <span class=n>See</span> <span class=n>accompanying</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>LICENSE</span> <span class=n>file</span><span class=o>.</span>
</span></span><span class=line><span class=cl> <span class=o>*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>package</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>workloads</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.*</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>generator</span><span class=o>.*</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>generator</span><span class=o>.</span><span class=n>UniformLongGenerator</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>measurements</span><span class=o>.</span><span class=n>Measurements</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>IOException</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>//</span> <span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>nio</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=n>Files</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>//</span> <span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>nio</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=n>Paths</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>util</span><span class=o>.*</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl> <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>core</span> <span class=n>benchmark</span> <span class=n>scenario</span><span class=o>.</span> <span class=n>Represents</span> <span class=n>a</span> <span class=n>set</span> <span class=n>of</span> <span class=n>clients</span> <span class=n>doing</span> <span class=n>simple</span> <span class=n>CRUD</span> <span class=n>operations</span><span class=o>.</span> <span class=n>The</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>relative</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>different</span> <span class=n>kinds</span> <span class=n>of</span> <span class=n>operations</span><span class=p>,</span> <span class=ow>and</span> <span class=n>other</span> <span class=n>properties</span> <span class=n>of</span> <span class=n>the</span> <span class=n>workload</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>are</span> <span class=n>controlled</span> <span class=n>by</span> <span class=n>parameters</span> <span class=n>specified</span> <span class=n>at</span> <span class=n>runtime</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Properties</span> <span class=n>to</span> <span class=n>control</span> <span class=n>the</span> <span class=n>client</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>UL</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>fieldcount</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>fields</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>record</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>fieldlength</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>the</span> <span class=n>size</span> <span class=n>of</span> <span class=n>each</span> <span class=n>field</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>minfieldlength</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>the</span> <span class=n>minimum</span> <span class=n>size</span> <span class=n>of</span> <span class=n>each</span> <span class=n>field</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>readallfields</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>should</span> <span class=n>reads</span> <span class=n>read</span> <span class=n>all</span> <span class=n>fields</span> <span class=p>(</span><span class=bp>true</span><span class=p>)</span> <span class=ow>or</span> <span class=n>just</span> <span class=n>one</span> <span class=p>(</span><span class=bp>false</span><span class=p>)</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=bp>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>writeallfields</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>should</span> <span class=n>updates</span> <span class=ow>and</span> <span class=n>read</span><span class=o>/</span><span class=n>modify</span><span class=o>/</span><span class=n>writes</span> <span class=n>update</span> <span class=n>all</span> <span class=n>fields</span> <span class=p>(</span><span class=bp>true</span><span class=p>)</span> <span class=ow>or</span> <span class=n>just</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>one</span> <span class=p>(</span><span class=bp>false</span><span class=p>)</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=bp>false</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>readproportion</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>operations</span> <span class=n>should</span> <span class=n>be</span> <span class=n>reads</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mf>0.95</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>updateproportion</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>operations</span> <span class=n>should</span> <span class=n>be</span> <span class=n>updates</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mf>0.05</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>insertproportion</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>operations</span> <span class=n>should</span> <span class=n>be</span> <span class=n>inserts</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>scanproportion</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>operations</span> <span class=n>should</span> <span class=n>be</span> <span class=n>scans</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>readmodifywriteproportion</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>operations</span> <span class=n>should</span> <span class=n>be</span> <span class=n>read</span> <span class=n>a</span> <span class=n>record</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>modify</span> <span class=n>it</span><span class=p>,</span> <span class=n>write</span> <span class=n>it</span> <span class=n>back</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>requestdistribution</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>distribution</span> <span class=n>should</span> <span class=n>be</span> <span class=n>used</span> <span class=n>to</span> <span class=n>select</span> <span class=n>the</span> <span class=n>records</span> <span class=n>to</span> <span class=n>operate</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>on</span> <span class=o>-</span> <span class=n>uniform</span><span class=p>,</span> <span class=n>zipfian</span><span class=p>,</span> <span class=n>hotspot</span><span class=p>,</span> <span class=n>sequential</span><span class=p>,</span> <span class=n>exponential</span> <span class=ow>or</span> <span class=n>latest</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=n>uniform</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>minscanlength</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>scans</span><span class=p>,</span> <span class=n>what</span> <span class=n>is</span> <span class=n>the</span> <span class=n>minimum</span> <span class=n>number</span> <span class=n>of</span> <span class=n>records</span> <span class=n>to</span> <span class=n>scan</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>maxscanlength</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>scans</span><span class=p>,</span> <span class=n>what</span> <span class=n>is</span> <span class=n>the</span> <span class=n>maximum</span> <span class=n>number</span> <span class=n>of</span> <span class=n>records</span> <span class=n>to</span> <span class=n>scan</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>scanlengthdistribution</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>scans</span><span class=p>,</span> <span class=n>what</span> <span class=n>distribution</span> <span class=n>should</span> <span class=n>be</span> <span class=n>used</span> <span class=n>to</span> <span class=n>choose</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>number</span> <span class=n>of</span> <span class=n>records</span> <span class=n>to</span> <span class=n>scan</span><span class=p>,</span> <span class=k>for</span> <span class=n>each</span> <span class=n>scan</span><span class=p>,</span> <span class=n>between</span> <span class=mi>1</span> <span class=ow>and</span> <span class=n>maxscanlength</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=n>uniform</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>insertstart</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>parallel</span> <span class=n>loads</span> <span class=ow>and</span> <span class=n>runs</span><span class=p>,</span> <span class=n>defines</span> <span class=n>the</span> <span class=n>starting</span> <span class=n>record</span> <span class=k>for</span> <span class=n>this</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>YCSB</span> <span class=n>instance</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>insertcount</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>parallel</span> <span class=n>loads</span> <span class=ow>and</span> <span class=n>runs</span><span class=p>,</span> <span class=n>defines</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>records</span> <span class=k>for</span> <span class=n>this</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>YCSB</span> <span class=n>instance</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=n>recordcount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>zeropadding</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=k>for</span> <span class=n>generating</span> <span class=n>a</span> <span class=n>record</span> <span class=n>sequence</span> <span class=n>compatible</span> <span class=n>with</span> <span class=n>string</span> <span class=n>sort</span> <span class=n>order</span> <span class=n>by</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=mi>0</span> <span class=n>padding</span> <span class=n>the</span> <span class=n>record</span> <span class=n>number</span><span class=o>.</span> <span class=n>Controls</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=mi>0</span><span class=n>s</span> <span class=n>to</span> <span class=n>use</span> <span class=k>for</span> <span class=n>padding</span><span class=o>.</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>For</span> <span class=n>example</span> <span class=k>for</span> <span class=n>row</span> <span class=mi>5</span><span class=p>,</span> <span class=n>with</span> <span class=n>zeropadding</span><span class=o>=</span><span class=mi>1</span> <span class=n>you</span> <span class=n>get</span> <span class=s1>&#39;user5&#39;</span> <span class=n>key</span> <span class=ow>and</span> <span class=n>with</span> <span class=n>zeropading</span><span class=o>=</span><span class=mi>8</span> <span class=n>you</span> <span class=n>get</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=s1>&#39;user00000005&#39;</span> <span class=n>key</span><span class=o>.</span> <span class=n>In</span> <span class=n>order</span> <span class=n>to</span> <span class=n>see</span> <span class=n>its</span> <span class=n>impact</span><span class=p>,</span> <span class=n>zeropadding</span> <span class=n>needs</span> <span class=n>to</span> <span class=n>be</span> <span class=n>bigger</span> <span class=n>than</span> <span class=n>number</span> <span class=n>of</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>digits</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>record</span> <span class=n>number</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>insertorder</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>should</span> <span class=n>records</span> <span class=n>be</span> <span class=n>inserted</span> <span class=ow>in</span> <span class=n>order</span> <span class=n>by</span> <span class=n>key</span> <span class=p>(</span><span class=s2>&#34;ordered&#34;</span><span class=p>),</span> <span class=ow>or</span> <span class=ow>in</span> <span class=n>hashed</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>order</span> <span class=p>(</span><span class=s2>&#34;hashed&#34;</span><span class=p>)</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=n>hashed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>LI</span><span class=o>&gt;&lt;</span><span class=n>b</span><span class=o>&gt;</span><span class=n>fieldnameprefix</span><span class=o>&lt;/</span><span class=n>b</span><span class=o>&gt;</span><span class=p>:</span> <span class=n>what</span> <span class=n>should</span> <span class=n>be</span> <span class=n>a</span> <span class=n>prefix</span> <span class=k>for</span> <span class=n>field</span> <span class=n>names</span><span class=p>,</span> <span class=n>the</span> <span class=n>shorter</span> <span class=n>may</span> <span class=n>decrease</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>required</span> <span class=n>storage</span> <span class=n>size</span> <span class=p>(</span><span class=n>default</span><span class=p>:</span> <span class=s2>&#34;field&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;/</span><span class=n>ul</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=n>public</span> <span class=k>class</span> <span class=n>MyWorkload</span> <span class=k>extends</span> <span class=n>Workload</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>database</span> <span class=n>table</span> <span class=n>to</span> <span class=n>run</span> <span class=n>queries</span> <span class=n>against</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>TABLENAME_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;table&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>database</span> <span class=n>table</span> <span class=n>to</span> <span class=n>run</span> <span class=n>queries</span> <span class=n>against</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>TABLENAME_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;usertable&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=ne>String</span> <span class=n>table</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>fields</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>record</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_COUNT_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;fieldcount&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Default</span> <span class=n>number</span> <span class=n>of</span> <span class=n>fields</span> <span class=ow>in</span> <span class=n>a</span> <span class=n>record</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_COUNT_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;10&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=n>fieldnames</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>field</span> <span class=n>length</span> <span class=n>distribution</span><span class=o>.</span> <span class=n>Options</span> <span class=n>are</span> <span class=s2>&#34;uniform&#34;</span><span class=p>,</span> <span class=s2>&#34;zipfian&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=p>(</span><span class=n>favouring</span> <span class=n>short</span> <span class=n>records</span><span class=p>),</span> <span class=s2>&#34;constant&#34;</span><span class=p>,</span> <span class=ow>and</span> <span class=s2>&#34;histogram&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=o>&lt;</span><span class=n>p</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>If</span> <span class=s2>&#34;uniform&#34;</span><span class=p>,</span> <span class=s2>&#34;zipfian&#34;</span> <span class=ow>or</span> <span class=s2>&#34;constant&#34;</span><span class=p>,</span> <span class=n>the</span> <span class=n>maximum</span> <span class=n>field</span> <span class=n>length</span> <span class=n>will</span> <span class=n>be</span> <span class=n>that</span> <span class=n>specified</span> <span class=n>by</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>fieldlength</span> <span class=n>property</span><span class=o>.</span> <span class=n>If</span> <span class=s2>&#34;histogram&#34;</span><span class=p>,</span> <span class=n>then</span> <span class=n>the</span> <span class=n>histogram</span> <span class=n>will</span> <span class=n>be</span> <span class=n>read</span> <span class=n>from</span> <span class=n>the</span> <span class=n>filename</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>specified</span> <span class=ow>in</span> <span class=n>the</span> <span class=s2>&#34;fieldlengthhistogram&#34;</span> <span class=n>property</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;fieldlengthdistribution&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>field</span> <span class=n>length</span> <span class=n>distribution</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;constant&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>length</span> <span class=n>of</span> <span class=n>a</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>bytes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;fieldlength&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>maximum</span> <span class=n>length</span> <span class=n>of</span> <span class=n>a</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>bytes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;100&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>minimum</span> <span class=n>length</span> <span class=n>of</span> <span class=n>a</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>bytes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MIN_FIELD_LENGTH_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;minfieldlength&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>minimum</span> <span class=n>length</span> <span class=n>of</span> <span class=n>a</span> <span class=n>field</span> <span class=ow>in</span> <span class=n>bytes</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MIN_FIELD_LENGTH_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>a</span> <span class=n>property</span> <span class=n>that</span> <span class=n>specifies</span> <span class=n>the</span> <span class=n>filename</span> <span class=n>containing</span> <span class=n>the</span> <span class=n>field</span> <span class=n>length</span> <span class=n>histogram</span> <span class=p>(</span><span class=n>only</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>used</span> <span class=k>if</span> <span class=n>fieldlengthdistribution</span> <span class=n>is</span> <span class=s2>&#34;histogram&#34;</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;fieldlengthhistogram&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>filename</span> <span class=n>containing</span> <span class=n>a</span> <span class=n>field</span> <span class=n>length</span> <span class=n>histogram</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;hist.txt&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Generator</span> <span class=n>object</span> <span class=n>that</span> <span class=n>produces</span> <span class=n>field</span> <span class=n>lengths</span><span class=o>.</span>  <span class=n>The</span> <span class=n>value</span> <span class=n>of</span> <span class=n>this</span> <span class=n>depends</span> <span class=n>on</span> <span class=n>the</span> <span class=n>properties</span> <span class=n>that</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>start</span> <span class=n>with</span> <span class=s2>&#34;FIELD_LENGTH_&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>NumberGenerator</span> <span class=n>fieldlengthgenerator</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>deciding</span> <span class=n>whether</span> <span class=n>to</span> <span class=n>read</span> <span class=n>one</span> <span class=n>field</span> <span class=p>(</span><span class=bp>false</span><span class=p>)</span> <span class=ow>or</span> <span class=n>all</span> <span class=n>fields</span> <span class=p>(</span><span class=bp>true</span><span class=p>)</span> <span class=n>of</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>a</span> <span class=n>record</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_ALL_FIELDS_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;readallfields&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>value</span> <span class=k>for</span> <span class=n>the</span> <span class=n>readallfields</span> <span class=n>property</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_ALL_FIELDS_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;true&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>boolean</span> <span class=n>readallfields</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>determining</span> <span class=n>how</span> <span class=n>to</span> <span class=n>read</span> <span class=n>all</span> <span class=n>the</span> <span class=n>fields</span> <span class=n>when</span> <span class=n>readallfields</span> <span class=n>is</span> <span class=bp>true</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>If</span> <span class=n>set</span> <span class=n>to</span> <span class=bp>true</span><span class=p>,</span> <span class=n>all</span> <span class=n>the</span> <span class=n>field</span> <span class=n>names</span> <span class=n>will</span> <span class=n>be</span> <span class=n>passed</span> <span class=n>into</span> <span class=n>the</span> <span class=n>underlying</span> <span class=n>client</span><span class=o>.</span> <span class=n>If</span> <span class=n>set</span> <span class=n>to</span> <span class=bp>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>null</span> <span class=n>will</span> <span class=n>be</span> <span class=n>passed</span> <span class=n>into</span> <span class=n>the</span> <span class=n>underlying</span> <span class=n>client</span><span class=o>.</span> <span class=n>When</span> <span class=n>passed</span> <span class=n>a</span> <span class=n>null</span><span class=p>,</span> <span class=n>some</span> <span class=n>clients</span> <span class=n>may</span> <span class=n>retrieve</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>the</span> <span class=n>entire</span> <span class=n>row</span> <span class=n>with</span> <span class=n>a</span> <span class=n>wildcard</span><span class=p>,</span> <span class=n>which</span> <span class=n>may</span> <span class=n>be</span> <span class=n>slower</span> <span class=n>than</span> <span class=n>naming</span> <span class=n>all</span> <span class=n>the</span> <span class=n>fields</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_ALL_FIELDS_BY_NAME_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;readallfieldsbyname&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>value</span> <span class=k>for</span> <span class=n>the</span> <span class=n>readallfieldsbyname</span> <span class=n>property</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;false&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>boolean</span> <span class=n>readallfieldsbyname</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>deciding</span> <span class=n>whether</span> <span class=n>to</span> <span class=n>write</span> <span class=n>one</span> <span class=n>field</span> <span class=p>(</span><span class=bp>false</span><span class=p>)</span> <span class=ow>or</span> <span class=n>all</span> <span class=n>fields</span> <span class=p>(</span><span class=bp>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>of</span> <span class=n>a</span> <span class=n>record</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>WRITE_ALL_FIELDS_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;writeallfields&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>value</span> <span class=k>for</span> <span class=n>the</span> <span class=n>writeallfields</span> <span class=n>property</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>WRITE_ALL_FIELDS_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;false&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>boolean</span> <span class=n>writeallfields</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>deciding</span> <span class=n>whether</span> <span class=n>to</span> <span class=n>check</span> <span class=n>all</span> <span class=n>returned</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>data</span> <span class=n>against</span> <span class=n>the</span> <span class=n>formation</span> <span class=n>template</span> <span class=n>to</span> <span class=n>ensure</span> <span class=n>data</span> <span class=n>integrity</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>DATA_INTEGRITY_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;dataintegrity&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>value</span> <span class=k>for</span> <span class=n>the</span> <span class=n>dataintegrity</span> <span class=n>property</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>DATA_INTEGRITY_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;false&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Set</span> <span class=n>to</span> <span class=bp>true</span> <span class=k>if</span> <span class=n>want</span> <span class=n>to</span> <span class=n>check</span> <span class=n>correctness</span> <span class=n>of</span> <span class=n>reads</span><span class=o>.</span> <span class=n>Must</span> <span class=n>also</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>be</span> <span class=n>set</span> <span class=n>to</span> <span class=bp>true</span> <span class=n>during</span> <span class=n>loading</span> <span class=n>phase</span> <span class=n>to</span> <span class=n>function</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>boolean</span> <span class=n>dataintegrity</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>reads</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_PROPORTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;readproportion&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>reads</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READ_PROPORTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.95&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>updates</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>UPDATE_PROPORTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;updateproportion&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>updates</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>UPDATE_PROPORTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.05&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>inserts</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERT_PROPORTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;insertproportion&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>inserts</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERT_PROPORTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>scans</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>SCAN_PROPORTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;scanproportion&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>scans</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>SCAN_PROPORTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>read</span><span class=o>-</span><span class=n>modify</span><span class=o>-</span><span class=n>write</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READMODIFYWRITE_PROPORTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;readmodifywriteproportion&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>proportion</span> <span class=n>of</span> <span class=n>transactions</span> <span class=n>that</span> <span class=n>are</span> <span class=n>scans</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>READMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>the</span> <span class=n>distribution</span> <span class=n>of</span> <span class=n>requests</span> <span class=n>across</span> <span class=n>the</span> <span class=n>keyspace</span><span class=o>.</span> <span class=n>Options</span> <span class=n>are</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=s2>&#34;uniform&#34;</span><span class=p>,</span> <span class=s2>&#34;zipfian&#34;</span> <span class=ow>and</span> <span class=s2>&#34;latest&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>REQUEST_DISTRIBUTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;requestdistribution&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>distribution</span> <span class=n>of</span> <span class=n>requests</span> <span class=n>across</span> <span class=n>the</span> <span class=n>keyspace</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>REQUEST_DISTRIBUTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;uniform&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>adding</span> <span class=n>zero</span> <span class=n>padding</span> <span class=n>to</span> <span class=n>record</span> <span class=n>numbers</span> <span class=ow>in</span> <span class=n>order</span> <span class=n>to</span> <span class=n>match</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>string</span> <span class=n>sort</span> <span class=n>order</span><span class=o>.</span> <span class=n>Controls</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=mi>0</span><span class=n>s</span> <span class=n>to</span> <span class=n>left</span> <span class=n>pad</span> <span class=n>with</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>ZERO_PADDING_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;zeropadding&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=n>zero</span> <span class=n>padding</span> <span class=n>value</span><span class=o>.</span> <span class=n>Matches</span> <span class=n>integer</span> <span class=n>sort</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>ZERO_PADDING_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=nb>min</span> <span class=n>scan</span> <span class=n>length</span> <span class=p>(</span><span class=n>number</span> <span class=n>of</span> <span class=n>records</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MIN_SCAN_LENGTH_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;minscanlength&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=nb>min</span> <span class=n>scan</span> <span class=n>length</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MIN_SCAN_LENGTH_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=nb>max</span> <span class=n>scan</span> <span class=n>length</span> <span class=p>(</span><span class=n>number</span> <span class=n>of</span> <span class=n>records</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MAX_SCAN_LENGTH_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;maxscanlength&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=nb>max</span> <span class=n>scan</span> <span class=n>length</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>MAX_SCAN_LENGTH_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;1000&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>scan</span> <span class=n>length</span> <span class=n>distribution</span><span class=o>.</span> <span class=n>Options</span> <span class=n>are</span> <span class=s2>&#34;uniform&#34;</span> <span class=ow>and</span> <span class=s2>&#34;zipfian&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=p>(</span><span class=n>favoring</span> <span class=n>short</span> <span class=n>scans</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>SCAN_LENGTH_DISTRIBUTION_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;scanlengthdistribution&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>default</span> <span class=nb>max</span> <span class=n>scan</span> <span class=n>length</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;uniform&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>The</span> <span class=n>name</span> <span class=n>of</span> <span class=n>the</span> <span class=n>property</span> <span class=k>for</span> <span class=n>the</span> <span class=n>order</span> <span class=n>to</span> <span class=n>insert</span> <span class=n>records</span><span class=o>.</span> <span class=n>Options</span> <span class=n>are</span> <span class=s2>&#34;ordered&#34;</span> <span class=ow>or</span> <span class=s2>&#34;hashed&#34;</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERT_ORDER_PROPERTY</span> <span class=o>=</span> <span class=s2>&#34;insertorder&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Default</span> <span class=n>insert</span> <span class=n>order</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERT_ORDER_PROPERTY_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;hashed&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Percentage</span> <span class=n>data</span> <span class=n>items</span> <span class=n>that</span> <span class=n>constitute</span> <span class=n>the</span> <span class=n>hot</span> <span class=n>set</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>HOTSPOT_DATA_FRACTION</span> <span class=o>=</span> <span class=s2>&#34;hotspotdatafraction&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Default</span> <span class=n>value</span> <span class=n>of</span> <span class=n>the</span> <span class=n>size</span> <span class=n>of</span> <span class=n>the</span> <span class=n>hot</span> <span class=n>set</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>HOTSPOT_DATA_FRACTION_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Percentage</span> <span class=n>operations</span> <span class=n>that</span> <span class=n>access</span> <span class=n>the</span> <span class=n>hot</span> <span class=n>set</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>HOTSPOT_OPN_FRACTION</span> <span class=o>=</span> <span class=s2>&#34;hotspotopnfraction&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Default</span> <span class=n>value</span> <span class=n>of</span> <span class=n>the</span> <span class=n>percentage</span> <span class=n>operations</span> <span class=n>accessing</span> <span class=n>the</span> <span class=n>hot</span> <span class=n>set</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>HOTSPOT_OPN_FRACTION_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0.8&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>How</span> <span class=n>many</span> <span class=n>times</span> <span class=n>to</span> <span class=n>retry</span> <span class=n>when</span> <span class=n>insertion</span> <span class=n>of</span> <span class=n>a</span> <span class=n>single</span> <span class=n>item</span> <span class=n>to</span> <span class=n>a</span> <span class=n>DB</span> <span class=n>fails</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERTION_RETRY_LIMIT</span> <span class=o>=</span> <span class=s2>&#34;core_workload_insertion_retry_limit&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERTION_RETRY_LIMIT_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>On</span> <span class=n>average</span><span class=p>,</span> <span class=n>how</span> <span class=n>long</span> <span class=n>to</span> <span class=n>wait</span> <span class=n>between</span> <span class=n>the</span> <span class=n>retries</span><span class=p>,</span> <span class=ow>in</span> <span class=n>seconds</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERTION_RETRY_INTERVAL</span> <span class=o>=</span> <span class=s2>&#34;core_workload_insertion_retry_interval&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>INSERTION_RETRY_INTERVAL_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Field</span> <span class=n>name</span> <span class=n>prefix</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_NAME_PREFIX</span> <span class=o>=</span> <span class=s2>&#34;fieldnameprefix&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Default</span> <span class=n>value</span> <span class=n>of</span> <span class=n>the</span> <span class=n>field</span> <span class=n>name</span> <span class=n>prefix</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>FIELD_NAME_PREFIX_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;field&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>DATA_FILE</span> <span class=o>=</span> <span class=s2>&#34;datafile&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>DATA_FILE_DEFAULT</span> <span class=o>=</span> <span class=s2>&#34;/data/publicdata/wikipedia/wikipedia.txt&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=k>static</span> <span class=ne>String</span> <span class=n>datapath</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=ne>String</span> <span class=n>getDataFile</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>datapath</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=ne>int</span> <span class=n>DATA_LENGTH</span> <span class=o>=</span> <span class=mi>1024</span><span class=p>;</span> <span class=o>//</span> <span class=err>每个数据块的大小为</span><span class=mi>1</span><span class=n>KB</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=k>static</span> <span class=n>byte</span><span class=p>[]</span> <span class=n>fileData</span><span class=p>;</span> <span class=o>//</span> <span class=err>存储文件的所有字节</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=k>static</span> <span class=ne>int</span> <span class=n>totalBytesRead</span><span class=p>;</span> <span class=o>//</span> <span class=err>文件中实际读取到的总字节数</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>NumberGenerator</span> <span class=n>keysequence</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>DiscreteGenerator</span> <span class=n>operationchooser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>NumberGenerator</span> <span class=n>keychooser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>NumberGenerator</span> <span class=n>fieldchooser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>AcknowledgedCounterGenerator</span> <span class=n>transactioninsertkeysequence</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>NumberGenerator</span> <span class=n>scanlength</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>boolean</span> <span class=n>orderedinserts</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>long</span> <span class=n>fieldcount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>long</span> <span class=n>recordcount</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=ne>int</span> <span class=n>zeropadding</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=ne>int</span> <span class=n>insertionRetryLimit</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=ne>int</span> <span class=n>insertionRetryInterval</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>FileGenerator</span> <span class=n>fg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>Measurements</span> <span class=n>measurements</span> <span class=o>=</span> <span class=n>Measurements</span><span class=o>.</span><span class=n>getMeasurements</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=k>static</span> <span class=ne>String</span> <span class=n>buildKeyName</span><span class=p>(</span><span class=n>long</span> <span class=n>keynum</span><span class=p>,</span> <span class=ne>int</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>boolean</span> <span class=n>orderedinserts</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>orderedinserts</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>keynum</span> <span class=o>=</span> <span class=n>Utils</span><span class=o>.</span><span class=n>hash</span><span class=p>(</span><span class=n>keynum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>value</span> <span class=o>=</span> <span class=n>Long</span><span class=o>.</span><span class=n>toString</span><span class=p>(</span><span class=n>keynum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>fill</span> <span class=o>=</span> <span class=n>zeropadding</span> <span class=o>-</span> <span class=n>value</span><span class=o>.</span><span class=n>length</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>prekey</span> <span class=o>=</span> <span class=s2>&#34;user&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=ne>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>fill</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>prekey</span> <span class=o>+=</span> <span class=s1>&#39;0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>prekey</span> <span class=o>+</span> <span class=n>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=k>static</span> <span class=n>NumberGenerator</span> <span class=n>getFieldLengthGenerator</span><span class=p>(</span><span class=n>Properties</span> <span class=n>p</span><span class=p>)</span> <span class=n>throws</span> <span class=n>WorkloadException</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>NumberGenerator</span> <span class=n>fieldlengthgenerator</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>fieldlengthdistribution</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY</span><span class=p>,</span> <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>fieldlength</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>FIELD_LENGTH_PROPERTY</span><span class=p>,</span> <span class=n>FIELD_LENGTH_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>minfieldlength</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>MIN_FIELD_LENGTH_PROPERTY</span><span class=p>,</span> <span class=n>MIN_FIELD_LENGTH_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>fieldlengthhistogram</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY</span><span class=p>,</span> <span class=n>FIELD_LENGTH_HISTOGRAM_FILE_PROPERTY_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>fieldlengthdistribution</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;constant&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>fieldlengthgenerator</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ConstantIntegerGenerator</span><span class=p>(</span><span class=n>fieldlength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>fieldlengthdistribution</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;uniform&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>fieldlengthgenerator</span> <span class=o>=</span> <span class=n>new</span> <span class=n>UniformLongGenerator</span><span class=p>(</span><span class=n>minfieldlength</span><span class=p>,</span> <span class=n>fieldlength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>fieldlengthdistribution</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;zipfian&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>fieldlengthgenerator</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ZipfianGenerator</span><span class=p>(</span><span class=n>minfieldlength</span><span class=p>,</span> <span class=n>fieldlength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>fieldlengthdistribution</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;histogram&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>fieldlengthgenerator</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HistogramGenerator</span><span class=p>(</span><span class=n>fieldlengthhistogram</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>throw</span> <span class=n>new</span> <span class=n>WorkloadException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Couldn&#39;t read field length histogram file: &#34;</span> <span class=o>+</span> <span class=n>fieldlengthhistogram</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>WorkloadException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;Unknown field length distribution </span><span class=se>\&#34;</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>fieldlengthdistribution</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fieldlengthgenerator</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=n>ThreadLocal</span><span class=o>&lt;</span><span class=n>byte</span><span class=p>[]</span><span class=o>&gt;</span> <span class=n>THREAD_LOCAL_FILE_DATA</span> <span class=o>=</span> <span class=n>ThreadLocal</span><span class=o>.</span><span class=n>withInitial</span><span class=p>(()</span> <span class=o>-&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=k>return</span> <span class=n>Files</span><span class=o>.</span><span class=n>readAllBytes</span><span class=p>(</span><span class=n>Paths</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>datapath</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=n>throw</span> <span class=n>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=s2>&#34;Failed to read data from file: &#34;</span> <span class=o>+</span> <span class=n>datapath</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=n>ThreadLocal</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>THREAD_LOCAL_TOTAL_BYTES_READ</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=n>ThreadLocal</span><span class=o>.</span><span class=n>withInitial</span><span class=p>(()</span> <span class=o>-&gt;</span> <span class=n>THREAD_LOCAL_FILE_DATA</span><span class=o>.</span><span class=n>get</span><span class=p>()</span><span class=o>.</span><span class=n>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>public</span> <span class=k>static</span> <span class=n>byte</span><span class=p>[]</span> <span class=n>getThreadLocalFileData</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=k>return</span> <span class=n>THREAD_LOCAL_FILE_DATA</span><span class=o>.</span><span class=n>get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>public</span> <span class=k>static</span> <span class=ne>int</span> <span class=n>getThreadLocalTotalBytesRead</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=k>return</span> <span class=n>THREAD_LOCAL_TOTAL_BYTES_READ</span><span class=o>.</span><span class=n>get</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Initialize</span> <span class=n>the</span> <span class=n>scenario</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Called</span> <span class=n>once</span><span class=p>,</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>main</span> <span class=n>client</span> <span class=n>thread</span><span class=p>,</span> <span class=n>before</span> <span class=n>any</span> <span class=n>operations</span> <span class=n>are</span> <span class=n>started</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>Override</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>init</span><span class=p>(</span><span class=n>Properties</span> <span class=n>p</span><span class=p>)</span> <span class=n>throws</span> <span class=n>WorkloadException</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>table</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>TABLENAME_PROPERTY</span><span class=p>,</span> <span class=n>TABLENAME_PROPERTY_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>datapath</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>DATA_FILE</span><span class=p>,</span> <span class=n>DATA_FILE_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span>   <span class=o>//</span> <span class=err>在类加载时初始化并读取文件内容到内存中</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span>   <span class=n>fileData</span> <span class=o>=</span> <span class=n>Files</span><span class=o>.</span><span class=n>readAllBytes</span><span class=p>(</span><span class=n>Paths</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>datapath</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span>   <span class=n>totalBytesRead</span> <span class=o>=</span> <span class=n>fileData</span><span class=o>.</span><span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span>   <span class=n>throw</span> <span class=n>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=s2>&#34;Failed to read data from file: &#34;</span> <span class=o>+</span> <span class=n>datapath</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>fileData</span> <span class=o>=</span> <span class=n>getThreadLocalFileData</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>totalBytesRead</span> <span class=o>=</span> <span class=n>getThreadLocalTotalBytesRead</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fieldcount</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Long</span><span class=o>.</span><span class=n>parseLong</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>FIELD_COUNT_PROPERTY</span><span class=p>,</span> <span class=n>FIELD_COUNT_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=ne>String</span> <span class=n>fieldnameprefix</span> <span class=o>=</span> <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>FIELD_NAME_PREFIX</span><span class=p>,</span> <span class=n>FIELD_NAME_PREFIX_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>fieldnames</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=ne>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>fieldcount</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>fieldnames</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>fieldnameprefix</span> <span class=o>+</span> <span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>fieldlengthgenerator</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>getFieldLengthGenerator</span><span class=p>(</span><span class=n>p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>recordcount</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Long</span><span class=o>.</span><span class=n>parseLong</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>Client</span><span class=o>.</span><span class=n>RECORD_COUNT_PROPERTY</span><span class=p>,</span> <span class=n>Client</span><span class=o>.</span><span class=n>DEFAULT_RECORD_COUNT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>recordcount</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>recordcount</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=n>MAX_VALUE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>requestdistrib</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>REQUEST_DISTRIBUTION_PROPERTY</span><span class=p>,</span> <span class=n>REQUEST_DISTRIBUTION_PROPERTY_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>minscanlength</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>MIN_SCAN_LENGTH_PROPERTY</span><span class=p>,</span> <span class=n>MIN_SCAN_LENGTH_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>maxscanlength</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>MAX_SCAN_LENGTH_PROPERTY</span><span class=p>,</span> <span class=n>MAX_SCAN_LENGTH_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>scanlengthdistrib</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>SCAN_LENGTH_DISTRIBUTION_PROPERTY</span><span class=p>,</span> <span class=n>SCAN_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>insertstart</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Long</span><span class=o>.</span><span class=n>parseLong</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>INSERT_START_PROPERTY</span><span class=p>,</span> <span class=n>INSERT_START_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>insertcount</span><span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>INSERT_COUNT_PROPERTY</span><span class=p>,</span> <span class=ne>String</span><span class=o>.</span><span class=n>valueOf</span><span class=p>(</span><span class=n>recordcount</span> <span class=o>-</span> <span class=n>insertstart</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>Confirm</span> <span class=n>valid</span> <span class=n>values</span> <span class=k>for</span> <span class=n>insertstart</span> <span class=ow>and</span> <span class=n>insertcount</span> <span class=ow>in</span> <span class=n>relation</span> <span class=n>to</span> <span class=n>recordcount</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>recordcount</span> <span class=o>&lt;</span> <span class=p>(</span><span class=n>insertstart</span> <span class=o>+</span> <span class=n>insertcount</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Invalid combination of insertstart, insertcount and recordcount.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;recordcount must be bigger than insertstart + insertcount.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>zeropadding</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>ZERO_PADDING_PROPERTY</span><span class=p>,</span> <span class=n>ZERO_PADDING_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>readallfields</span> <span class=o>=</span> <span class=n>Boolean</span><span class=o>.</span><span class=n>parseBoolean</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>READ_ALL_FIELDS_PROPERTY</span><span class=p>,</span> <span class=n>READ_ALL_FIELDS_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>readallfieldsbyname</span> <span class=o>=</span> <span class=n>Boolean</span><span class=o>.</span><span class=n>parseBoolean</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>READ_ALL_FIELDS_BY_NAME_PROPERTY</span><span class=p>,</span> <span class=n>READ_ALL_FIELDS_BY_NAME_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>writeallfields</span> <span class=o>=</span> <span class=n>Boolean</span><span class=o>.</span><span class=n>parseBoolean</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>WRITE_ALL_FIELDS_PROPERTY</span><span class=p>,</span> <span class=n>WRITE_ALL_FIELDS_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dataintegrity</span> <span class=o>=</span> <span class=n>Boolean</span><span class=o>.</span><span class=n>parseBoolean</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>DATA_INTEGRITY_PROPERTY</span><span class=p>,</span> <span class=n>DATA_INTEGRITY_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>Confirm</span> <span class=n>that</span> <span class=n>fieldlengthgenerator</span> <span class=n>returns</span> <span class=n>a</span> <span class=n>constant</span> <span class=k>if</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>integrity</span> <span class=n>check</span> <span class=n>requested</span><span class=o>.</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>FIELD_LENGTH_DISTRIBUTION_PROPERTY_DEFAULT</span><span class=p>))</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=s2>&#34;constant&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Must have constant field size to check data integrity.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>exit</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>out</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Data integrity is enabled.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>INSERT_ORDER_PROPERTY</span><span class=p>,</span> <span class=n>INSERT_ORDER_PROPERTY_DEFAULT</span><span class=p>)</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;hashed&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>orderedinserts</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>orderedinserts</span> <span class=o>=</span> <span class=bp>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>keysequence</span> <span class=o>=</span> <span class=n>new</span> <span class=n>CounterGenerator</span><span class=p>(</span><span class=n>insertstart</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>operationchooser</span> <span class=o>=</span> <span class=n>createOperationGenerator</span><span class=p>(</span><span class=n>p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>transactioninsertkeysequence</span> <span class=o>=</span> <span class=n>new</span> <span class=n>AcknowledgedCounterGenerator</span><span class=p>(</span><span class=n>recordcount</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;uniform&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>UniformLongGenerator</span><span class=p>(</span><span class=n>insertstart</span><span class=p>,</span> <span class=n>insertstart</span> <span class=o>+</span> <span class=n>insertcount</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;exponential&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>double</span> <span class=n>percentile</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>ExponentialGenerator</span><span class=o>.</span><span class=n>EXPONENTIAL_PERCENTILE_PROPERTY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>ExponentialGenerator</span><span class=o>.</span><span class=n>EXPONENTIAL_PERCENTILE_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>double</span> <span class=n>frac</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>ExponentialGenerator</span><span class=o>.</span><span class=n>EXPONENTIAL_FRAC_PROPERTY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>ExponentialGenerator</span><span class=o>.</span><span class=n>EXPONENTIAL_FRAC_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ExponentialGenerator</span><span class=p>(</span><span class=n>percentile</span><span class=p>,</span> <span class=n>recordcount</span> <span class=o>*</span> <span class=n>frac</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;sequential&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>SequentialGenerator</span><span class=p>(</span><span class=n>insertstart</span><span class=p>,</span> <span class=n>insertstart</span> <span class=o>+</span> <span class=n>insertcount</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;zipfian&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>it</span> <span class=n>does</span> <span class=n>this</span> <span class=n>by</span> <span class=n>generating</span> <span class=n>a</span> <span class=n>random</span> <span class=s2>&#34;next key&#34;</span> <span class=ow>in</span> <span class=n>part</span> <span class=n>by</span> <span class=n>taking</span> <span class=n>the</span> <span class=n>modulus</span> <span class=n>over</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>number</span> <span class=n>of</span> <span class=n>keys</span><span class=o>.</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>If</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>keys</span> <span class=n>changes</span><span class=p>,</span> <span class=n>this</span> <span class=n>would</span> <span class=n>shift</span> <span class=n>the</span> <span class=n>modulus</span><span class=p>,</span> <span class=ow>and</span> <span class=n>we</span> <span class=n>don</span><span class=s1>&#39;t want that to</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>change</span> <span class=n>which</span> <span class=n>keys</span> <span class=n>are</span> <span class=n>popular</span> <span class=n>so</span> <span class=n>we</span><span class=s1>&#39;ll actually construct the scrambled zipfian generator</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>with</span> <span class=n>a</span> <span class=n>keyspace</span> <span class=n>that</span> <span class=n>is</span> <span class=n>larger</span> <span class=n>than</span> <span class=n>exists</span> <span class=n>at</span> <span class=n>the</span> <span class=n>beginning</span> <span class=n>of</span> <span class=n>the</span> <span class=n>test</span><span class=o>.</span> <span class=n>that</span> <span class=n>is</span><span class=p>,</span> <span class=n>we</span><span class=s1>&#39;ll predict</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>inserts</span><span class=p>,</span> <span class=ow>and</span> <span class=n>tell</span> <span class=n>the</span> <span class=n>scrambled</span> <span class=n>zipfian</span> <span class=n>generator</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>existing</span> <span class=n>keys</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>plus</span> <span class=n>the</span> <span class=n>number</span> <span class=n>of</span> <span class=n>predicted</span> <span class=n>keys</span> <span class=n>as</span> <span class=n>the</span> <span class=n>total</span> <span class=n>keyspace</span><span class=o>.</span> <span class=n>then</span><span class=p>,</span> <span class=k>if</span> <span class=n>the</span> <span class=n>generator</span> <span class=n>picks</span> <span class=n>a</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>that</span> <span class=n>hasn</span><span class=s1>&#39;t been inserted yet, will just ignore it and pick another key. this way, the size of</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>the</span> <span class=n>keyspace</span> <span class=n>doesn</span><span class=s1>&#39;t change from the perspective of the scrambled zipfian generator</span>
</span></span><span class=line><span class=cl>      <span class=n>final</span> <span class=n>double</span> <span class=n>insertproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>INSERT_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>INSERT_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=ne>int</span> <span class=n>opcount</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>Client</span><span class=o>.</span><span class=n>OPERATION_COUNT_PROPERTY</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=ne>int</span> <span class=n>expectednewkeys</span> <span class=o>=</span> <span class=p>(</span><span class=ne>int</span><span class=p>)</span> <span class=p>((</span><span class=n>opcount</span><span class=p>)</span> <span class=o>*</span> <span class=n>insertproportion</span> <span class=o>*</span> <span class=mf>2.0</span><span class=p>);</span> <span class=o>//</span> <span class=mi>2</span> <span class=n>is</span> <span class=n>fudge</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ScrambledZipfianGenerator</span><span class=p>(</span><span class=n>insertstart</span><span class=p>,</span> <span class=n>insertstart</span> <span class=o>+</span> <span class=n>insertcount</span> <span class=o>+</span> <span class=n>expectednewkeys</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;latest&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>SkewedLatestGenerator</span><span class=p>(</span><span class=n>transactioninsertkeysequence</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>requestdistrib</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=s2>&#34;hotspot&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>double</span> <span class=n>hotsetfraction</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>HOTSPOT_DATA_FRACTION</span><span class=p>,</span> <span class=n>HOTSPOT_DATA_FRACTION_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>double</span> <span class=n>hotopnfraction</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>          <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>HOTSPOT_OPN_FRACTION</span><span class=p>,</span> <span class=n>HOTSPOT_OPN_FRACTION_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=n>keychooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HotspotIntegerGenerator</span><span class=p>(</span><span class=n>insertstart</span><span class=p>,</span> <span class=n>insertstart</span> <span class=o>+</span> <span class=n>insertcount</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=n>hotsetfraction</span><span class=p>,</span> <span class=n>hotopnfraction</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>WorkloadException</span><span class=p>(</span><span class=s2>&#34;Unknown request distribution </span><span class=se>\&#34;</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>requestdistrib</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fieldchooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>UniformLongGenerator</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>fieldcount</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>scanlengthdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;uniform&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>scanlength</span> <span class=o>=</span> <span class=n>new</span> <span class=n>UniformLongGenerator</span><span class=p>(</span><span class=n>minscanlength</span><span class=p>,</span> <span class=n>maxscanlength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>scanlengthdistrib</span><span class=o>.</span><span class=n>compareTo</span><span class=p>(</span><span class=s2>&#34;zipfian&#34;</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>scanlength</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ZipfianGenerator</span><span class=p>(</span><span class=n>minscanlength</span><span class=p>,</span> <span class=n>maxscanlength</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>WorkloadException</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;Distribution </span><span class=se>\&#34;</span><span class=s2>&#34;</span> <span class=o>+</span> <span class=n>scanlengthdistrib</span> <span class=o>+</span> <span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2> not allowed for scan length&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>fg</span> <span class=o>=</span> <span class=n>new</span> <span class=n>FileGenerator</span><span class=p>(</span><span class=n>datapath</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>insertionRetryLimit</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>INSERTION_RETRY_LIMIT</span><span class=p>,</span> <span class=n>INSERTION_RETRY_LIMIT_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>insertionRetryInterval</span> <span class=o>=</span> <span class=n>Integer</span><span class=o>.</span><span class=n>parseInt</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>INSERTION_RETRY_INTERVAL</span><span class=p>,</span> <span class=n>INSERTION_RETRY_INTERVAL_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Builds</span> <span class=n>a</span> <span class=n>value</span> <span class=k>for</span> <span class=n>a</span> <span class=n>randomly</span> <span class=n>chosen</span> <span class=n>field</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>buildSingleValue</span><span class=p>(</span><span class=ne>String</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>value</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>fieldkey</span> <span class=o>=</span> <span class=n>fieldnames</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>fieldchooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=n>ByteIterator</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>StringByteIterator</span><span class=p>(</span><span class=n>buildDeterministicValue</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>fieldkey</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>byte</span><span class=p>[]</span> <span class=n>dataBlock</span> <span class=o>=</span> <span class=n>getNextDataBlock</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>ByteArrayByteIterator</span><span class=p>(</span><span class=n>dataBlock</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>RandomByteIterator</span><span class=p>(</span><span class=n>fieldlengthgenerator</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>longValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>      <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>StringByteIterator</span><span class=p>(</span><span class=n>fg</span><span class=o>.</span><span class=n>nextValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>value</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>fieldkey</span><span class=p>,</span> <span class=n>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Builds</span> <span class=n>values</span> <span class=k>for</span> <span class=n>all</span> <span class=n>fields</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>buildValues</span><span class=p>(</span><span class=ne>String</span> <span class=n>key</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>values</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashMap</span><span class=o>&lt;&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>offset</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=ne>String</span> <span class=n>fieldkey</span> <span class=p>:</span> <span class=n>fieldnames</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>ByteIterator</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>StringByteIterator</span><span class=p>(</span><span class=n>buildDeterministicValue</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>fieldkey</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>fill</span> <span class=n>with</span> <span class=n>random</span> <span class=n>data</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>RandomByteIterator</span><span class=p>(</span><span class=n>fieldlengthgenerator</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>longValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=ne>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>fieldlengthgenerator</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>longValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>byte</span><span class=p>[]</span> <span class=n>dataBlock</span> <span class=o>=</span> <span class=n>getNextDataBlock</span><span class=p>(</span><span class=n>offset</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=n>offset</span> <span class=o>+=</span> <span class=n>DATA_LENGTH</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=k>if</span> <span class=p>(</span><span class=n>offset</span> <span class=o>&gt;=</span> <span class=n>totalBytesRead</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span>   <span class=n>offset</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>//</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=n>new</span> <span class=n>StringByteIterator</span><span class=p>(</span><span class=n>fg</span><span class=o>.</span><span class=n>nextValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=n>values</span><span class=o>.</span><span class=n>put</span><span class=p>(</span><span class=n>fieldkey</span><span class=p>,</span> <span class=n>data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>values</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=n>private</span> <span class=n>byte</span><span class=p>[]</span> <span class=n>getNextDataBlock</span><span class=p>(</span><span class=ne>int</span> <span class=n>offset</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=n>byte</span><span class=p>[]</span> <span class=n>dataBlock</span> <span class=o>=</span> <span class=n>new</span> <span class=n>byte</span><span class=p>[</span><span class=n>DATA_LENGTH</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=o>//</span> <span class=err>如果偏移量在文件范围内</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=k>if</span> <span class=p>(</span><span class=n>offset</span> <span class=o>&lt;</span> <span class=n>totalBytesRead</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=ne>int</span> <span class=n>remainingBytes</span> <span class=o>=</span> <span class=n>totalBytesRead</span> <span class=o>-</span> <span class=n>offset</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=o>//</span> <span class=err>如果文件剩余数据大于或等于一个数据块，直接复制数据</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=k>if</span> <span class=p>(</span><span class=n>remainingBytes</span> <span class=o>&gt;=</span> <span class=n>DATA_LENGTH</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=n>System</span><span class=o>.</span><span class=n>arraycopy</span><span class=p>(</span><span class=n>fileData</span><span class=p>,</span> <span class=n>offset</span><span class=p>,</span> <span class=n>dataBlock</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>DATA_LENGTH</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=o>//</span> <span class=err>如果文件剩余数据小于一个数据块，则重复最后一个完整的数据块填充</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=ne>int</span> <span class=n>lastCompleteOffset</span> <span class=o>=</span> <span class=p>(</span><span class=n>totalBytesRead</span> <span class=o>/</span> <span class=n>DATA_LENGTH</span><span class=p>)</span> <span class=o>*</span> <span class=n>DATA_LENGTH</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=k>for</span> <span class=p>(</span><span class=ne>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>DATA_LENGTH</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>         <span class=n>dataBlock</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>fileData</span><span class=p>[(</span><span class=n>lastCompleteOffset</span> <span class=o>+</span> <span class=n>i</span><span class=p>)</span> <span class=o>%</span> <span class=n>totalBytesRead</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>       <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=o>//</span> <span class=err>如果超出文件末尾，回绕到文件开头</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>     <span class=n>System</span><span class=o>.</span><span class=n>arraycopy</span><span class=p>(</span><span class=n>fileData</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>dataBlock</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=n>DATA_LENGTH</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>//</span>   <span class=k>return</span> <span class=n>dataBlock</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=o>//</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Build</span> <span class=n>a</span> <span class=n>deterministic</span> <span class=n>value</span> <span class=n>given</span> <span class=n>the</span> <span class=n>key</span> <span class=n>information</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=ne>String</span> <span class=n>buildDeterministicValue</span><span class=p>(</span><span class=ne>String</span> <span class=n>key</span><span class=p>,</span> <span class=ne>String</span> <span class=n>fieldkey</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>size</span> <span class=o>=</span> <span class=n>fieldlengthgenerator</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>StringBuilder</span> <span class=n>sb</span> <span class=o>=</span> <span class=n>new</span> <span class=n>StringBuilder</span><span class=p>(</span><span class=n>size</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>key</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>fieldkey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>sb</span><span class=o>.</span><span class=n>length</span><span class=p>()</span> <span class=o>&lt;</span> <span class=n>size</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>sb</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>sb</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>sb</span><span class=o>.</span><span class=n>toString</span><span class=p>()</span><span class=o>.</span><span class=n>hashCode</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=n>setLength</span><span class=p>(</span><span class=n>size</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sb</span><span class=o>.</span><span class=n>toString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Do</span> <span class=n>one</span> <span class=n>insert</span> <span class=n>operation</span><span class=o>.</span> <span class=n>Because</span> <span class=n>it</span> <span class=n>will</span> <span class=n>be</span> <span class=n>called</span> <span class=n>concurrently</span> <span class=n>from</span> <span class=n>multiple</span> <span class=n>client</span> <span class=n>threads</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>this</span> <span class=n>function</span> <span class=n>must</span> <span class=n>be</span> <span class=n>thread</span> <span class=n>safe</span><span class=o>.</span> <span class=n>However</span><span class=p>,</span> <span class=n>avoid</span> <span class=n>synchronized</span><span class=p>,</span> <span class=ow>or</span> <span class=n>the</span> <span class=n>threads</span> <span class=n>will</span> <span class=n>block</span> <span class=n>waiting</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=k>for</span> <span class=n>each</span> <span class=n>other</span><span class=p>,</span> <span class=ow>and</span> <span class=n>it</span> <span class=n>will</span> <span class=n>be</span> <span class=n>difficult</span> <span class=n>to</span> <span class=n>reach</span> <span class=n>the</span> <span class=n>target</span> <span class=n>throughput</span><span class=o>.</span> <span class=n>Ideally</span><span class=p>,</span> <span class=n>this</span> <span class=n>function</span> <span class=n>would</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>have</span> <span class=n>no</span> <span class=n>side</span> <span class=n>effects</span> <span class=n>other</span> <span class=n>than</span> <span class=n>DB</span> <span class=n>operations</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>Override</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>boolean</span> <span class=n>doInsert</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>,</span> <span class=ne>Object</span> <span class=n>threadstate</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>keysequence</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>dbkey</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>values</span> <span class=o>=</span> <span class=n>buildValues</span><span class=p>(</span><span class=n>dbkey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Status</span> <span class=n>status</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>numOfRetries</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>status</span> <span class=o>=</span> <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>dbkey</span><span class=p>,</span> <span class=n>values</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>null</span> <span class=o>!=</span> <span class=n>status</span> <span class=o>&amp;&amp;</span> <span class=n>status</span><span class=o>.</span><span class=n>isOk</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>Retry</span> <span class=k>if</span> <span class=n>configured</span><span class=o>.</span> <span class=n>Without</span> <span class=n>retrying</span><span class=p>,</span> <span class=n>the</span> <span class=nb>load</span> <span class=n>process</span> <span class=n>will</span> <span class=n>fail</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>even</span> <span class=k>if</span> <span class=n>one</span> <span class=n>single</span> <span class=n>insertion</span> <span class=n>fails</span><span class=o>.</span> <span class=n>User</span> <span class=n>can</span> <span class=n>optionally</span> <span class=n>configure</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>an</span> <span class=n>insertion</span> <span class=n>retry</span> <span class=n>limit</span> <span class=p>(</span><span class=n>default</span> <span class=n>is</span> <span class=mi>0</span><span class=p>)</span> <span class=n>to</span> <span class=n>enable</span> <span class=n>retry</span><span class=o>.</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>++</span><span class=n>numOfRetries</span> <span class=o>&lt;=</span> <span class=n>insertionRetryLimit</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Retrying insertion, retry count: &#34;</span> <span class=o>+</span> <span class=n>numOfRetries</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=o>//</span> <span class=n>Sleep</span> <span class=k>for</span> <span class=n>a</span> <span class=n>random</span> <span class=n>number</span> <span class=n>between</span> <span class=p>[</span><span class=mf>0.8</span><span class=p>,</span> <span class=mf>1.2</span><span class=p>)</span><span class=o>*</span><span class=n>insertionRetryInterval</span><span class=o>.</span>
</span></span><span class=line><span class=cl>          <span class=ne>int</span> <span class=n>sleepTime</span> <span class=o>=</span> <span class=p>(</span><span class=ne>int</span><span class=p>)</span> <span class=p>(</span><span class=mi>1000</span> <span class=o>*</span> <span class=n>insertionRetryInterval</span> <span class=o>*</span> <span class=p>(</span><span class=mf>0.8</span> <span class=o>+</span> <span class=mf>0.4</span> <span class=o>*</span> <span class=n>Math</span><span class=o>.</span><span class=n>random</span><span class=p>()));</span>
</span></span><span class=line><span class=cl>          <span class=ne>Thread</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=n>sleepTime</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>InterruptedException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Error inserting, not retrying any more. number of attempts: &#34;</span> <span class=o>+</span> <span class=n>numOfRetries</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Insertion Retry Limit: &#34;</span> <span class=o>+</span> <span class=n>insertionRetryLimit</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=bp>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>null</span> <span class=o>!=</span> <span class=n>status</span> <span class=o>&amp;&amp;</span> <span class=n>status</span><span class=o>.</span><span class=n>isOk</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Do</span> <span class=n>one</span> <span class=n>transaction</span> <span class=n>operation</span><span class=o>.</span> <span class=n>Because</span> <span class=n>it</span> <span class=n>will</span> <span class=n>be</span> <span class=n>called</span> <span class=n>concurrently</span> <span class=n>from</span> <span class=n>multiple</span> <span class=n>client</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>threads</span><span class=p>,</span> <span class=n>this</span> <span class=n>function</span> <span class=n>must</span> <span class=n>be</span> <span class=n>thread</span> <span class=n>safe</span><span class=o>.</span> <span class=n>However</span><span class=p>,</span> <span class=n>avoid</span> <span class=n>synchronized</span><span class=p>,</span> <span class=ow>or</span> <span class=n>the</span> <span class=n>threads</span> <span class=n>will</span> <span class=n>block</span> <span class=n>waiting</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=k>for</span> <span class=n>each</span> <span class=n>other</span><span class=p>,</span> <span class=ow>and</span> <span class=n>it</span> <span class=n>will</span> <span class=n>be</span> <span class=n>difficult</span> <span class=n>to</span> <span class=n>reach</span> <span class=n>the</span> <span class=n>target</span> <span class=n>throughput</span><span class=o>.</span> <span class=n>Ideally</span><span class=p>,</span> <span class=n>this</span> <span class=n>function</span> <span class=n>would</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>have</span> <span class=n>no</span> <span class=n>side</span> <span class=n>effects</span> <span class=n>other</span> <span class=n>than</span> <span class=n>DB</span> <span class=n>operations</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>Override</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>boolean</span> <span class=n>doTransaction</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>,</span> <span class=ne>Object</span> <span class=n>threadstate</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>operation</span> <span class=o>=</span> <span class=n>operationchooser</span><span class=o>.</span><span class=n>nextString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>operation</span> <span class=o>==</span> <span class=n>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=p>(</span><span class=n>operation</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s2>&#34;READ&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>doTransactionRead</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s2>&#34;UPDATE&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>doTransactionUpdate</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s2>&#34;INSERT&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>doTransactionInsert</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>case</span> <span class=s2>&#34;SCAN&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>doTransactionScan</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>doTransactionReadModifyWrite</span><span class=p>(</span><span class=n>db</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Results</span> <span class=n>are</span> <span class=n>reported</span> <span class=ow>in</span> <span class=n>the</span> <span class=n>first</span> <span class=n>three</span> <span class=n>buckets</span> <span class=n>of</span> <span class=n>the</span> <span class=n>histogram</span> <span class=n>under</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>the</span> <span class=n>label</span> <span class=s2>&#34;VERIFY&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Bucket</span> <span class=mi>0</span> <span class=n>means</span> <span class=n>the</span> <span class=n>expected</span> <span class=n>data</span> <span class=n>was</span> <span class=n>returned</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Bucket</span> <span class=mi>1</span> <span class=n>means</span> <span class=n>incorrect</span> <span class=n>data</span> <span class=n>was</span> <span class=n>returned</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Bucket</span> <span class=mi>2</span> <span class=n>means</span> <span class=n>null</span> <span class=n>data</span> <span class=n>was</span> <span class=n>returned</span> <span class=n>when</span> <span class=n>some</span> <span class=n>data</span> <span class=n>was</span> <span class=n>expected</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=n>void</span> <span class=n>verifyRow</span><span class=p>(</span><span class=ne>String</span> <span class=n>key</span><span class=p>,</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>cells</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Status</span> <span class=n>verifyStatus</span> <span class=o>=</span> <span class=n>Status</span><span class=o>.</span><span class=n>OK</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>startTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=n>nanoTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>cells</span><span class=o>.</span><span class=n>isEmpty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=p>(</span><span class=n>Map</span><span class=o>.</span><span class=n>Entry</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>entry</span> <span class=p>:</span> <span class=n>cells</span><span class=o>.</span><span class=n>entrySet</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>entry</span><span class=o>.</span><span class=n>getValue</span><span class=p>()</span><span class=o>.</span><span class=n>toString</span><span class=p>()</span><span class=o>.</span><span class=n>equals</span><span class=p>(</span><span class=n>buildDeterministicValue</span><span class=p>(</span><span class=n>key</span><span class=p>,</span> <span class=n>entry</span><span class=o>.</span><span class=n>getKey</span><span class=p>())))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=n>verifyStatus</span> <span class=o>=</span> <span class=n>Status</span><span class=o>.</span><span class=n>UNEXPECTED_STATE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>          <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>This</span> <span class=n>assumes</span> <span class=n>that</span> <span class=n>null</span> <span class=n>data</span> <span class=n>is</span> <span class=n>never</span> <span class=n>valid</span>
</span></span><span class=line><span class=cl>      <span class=n>verifyStatus</span> <span class=o>=</span> <span class=n>Status</span><span class=o>.</span><span class=n>ERROR</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=n>nanoTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>measurements</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&#34;VERIFY&#34;</span><span class=p>,</span> <span class=p>(</span><span class=ne>int</span><span class=p>)</span> <span class=p>(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>startTime</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>measurements</span><span class=o>.</span><span class=n>reportStatus</span><span class=p>(</span><span class=s2>&#34;VERIFY&#34;</span><span class=p>,</span> <span class=n>verifyStatus</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>long</span> <span class=n>nextKeynum</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>keychooser</span> <span class=n>instanceof</span> <span class=n>ExponentialGenerator</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>keynum</span> <span class=o>=</span> <span class=n>transactioninsertkeysequence</span><span class=o>.</span><span class=n>lastValue</span><span class=p>()</span> <span class=o>-</span> <span class=n>keychooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>keynum</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>keynum</span> <span class=o>=</span> <span class=n>keychooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>keynum</span> <span class=o>&gt;</span> <span class=n>transactioninsertkeysequence</span><span class=o>.</span><span class=n>lastValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>keynum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>doTransactionRead</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>a</span> <span class=n>random</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>nextKeynum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>keyname</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>readallfields</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>read</span> <span class=n>a</span> <span class=n>random</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>      <span class=ne>String</span> <span class=n>fieldname</span> <span class=o>=</span> <span class=n>fieldnames</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>fieldchooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>fields</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>fields</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>fieldname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span> <span class=o>||</span> <span class=n>readallfieldsbyname</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=k>pass</span> <span class=n>the</span> <span class=n>full</span> <span class=n>field</span> <span class=n>list</span> <span class=k>if</span> <span class=n>dataintegrity</span> <span class=n>is</span> <span class=n>on</span> <span class=k>for</span> <span class=n>verification</span>
</span></span><span class=line><span class=cl>      <span class=n>fields</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span><span class=p>(</span><span class=n>fieldnames</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>cells</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>keyname</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>cells</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>verifyRow</span><span class=p>(</span><span class=n>keyname</span><span class=p>,</span> <span class=n>cells</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>doTransactionReadModifyWrite</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>a</span> <span class=n>random</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>nextKeynum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>keyname</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>readallfields</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>read</span> <span class=n>a</span> <span class=n>random</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>      <span class=ne>String</span> <span class=n>fieldname</span> <span class=o>=</span> <span class=n>fieldnames</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>fieldchooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>fields</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>fields</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>fieldname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>values</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>writeallfields</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>new</span> <span class=n>data</span> <span class=k>for</span> <span class=n>all</span> <span class=n>the</span> <span class=n>fields</span>
</span></span><span class=line><span class=cl>      <span class=n>values</span> <span class=o>=</span> <span class=n>buildValues</span><span class=p>(</span><span class=n>keyname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>update</span> <span class=n>a</span> <span class=n>random</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>      <span class=n>values</span> <span class=o>=</span> <span class=n>buildSingleValue</span><span class=p>(</span><span class=n>keyname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=k>do</span> <span class=n>the</span> <span class=n>transaction</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>cells</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>ist</span> <span class=o>=</span> <span class=n>measurements</span><span class=o>.</span><span class=n>getIntendedStartTimeNs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>st</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=n>nanoTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>keyname</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>cells</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>keyname</span><span class=p>,</span> <span class=n>values</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>en</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=n>nanoTime</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dataintegrity</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>verifyRow</span><span class=p>(</span><span class=n>keyname</span><span class=p>,</span> <span class=n>cells</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>measurements</span><span class=o>.</span><span class=n>measure</span><span class=p>(</span><span class=s2>&#34;READ-MODIFY-WRITE&#34;</span><span class=p>,</span> <span class=p>(</span><span class=ne>int</span><span class=p>)</span> <span class=p>((</span><span class=n>en</span> <span class=o>-</span> <span class=n>st</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>measurements</span><span class=o>.</span><span class=n>measureIntended</span><span class=p>(</span><span class=s2>&#34;READ-MODIFY-WRITE&#34;</span><span class=p>,</span> <span class=p>(</span><span class=ne>int</span><span class=p>)</span> <span class=p>((</span><span class=n>en</span> <span class=o>-</span> <span class=n>ist</span><span class=p>)</span> <span class=o>/</span> <span class=mi>1000</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>doTransactionScan</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>a</span> <span class=n>random</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>nextKeynum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>startkeyname</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>a</span> <span class=n>random</span> <span class=n>scan</span> <span class=n>length</span>
</span></span><span class=line><span class=cl>    <span class=ne>int</span> <span class=n>len</span> <span class=o>=</span> <span class=n>scanlength</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=n>fields</span> <span class=o>=</span> <span class=n>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>readallfields</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>read</span> <span class=n>a</span> <span class=n>random</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>      <span class=ne>String</span> <span class=n>fieldname</span> <span class=o>=</span> <span class=n>fieldnames</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>fieldchooser</span><span class=o>.</span><span class=n>nextValue</span><span class=p>()</span><span class=o>.</span><span class=n>intValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>fields</span> <span class=o>=</span> <span class=n>new</span> <span class=n>HashSet</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=n>fields</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>fieldname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>scan</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>startkeyname</span><span class=p>,</span> <span class=n>len</span><span class=p>,</span> <span class=n>fields</span><span class=p>,</span> <span class=n>new</span> <span class=n>Vector</span><span class=o>&lt;</span><span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;&gt;</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>doTransactionUpdate</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>a</span> <span class=n>random</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>nextKeynum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=ne>String</span> <span class=n>keyname</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>values</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>writeallfields</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>new</span> <span class=n>data</span> <span class=k>for</span> <span class=n>all</span> <span class=n>the</span> <span class=n>fields</span>
</span></span><span class=line><span class=cl>      <span class=n>values</span> <span class=o>=</span> <span class=n>buildValues</span><span class=p>(</span><span class=n>keyname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=o>//</span> <span class=n>update</span> <span class=n>a</span> <span class=n>random</span> <span class=n>field</span>
</span></span><span class=line><span class=cl>      <span class=n>values</span> <span class=o>=</span> <span class=n>buildSingleValue</span><span class=p>(</span><span class=n>keyname</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>keyname</span><span class=p>,</span> <span class=n>values</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>void</span> <span class=n>doTransactionInsert</span><span class=p>(</span><span class=n>DB</span> <span class=n>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=o>//</span> <span class=n>choose</span> <span class=n>the</span> <span class=n>next</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>    <span class=n>long</span> <span class=n>keynum</span> <span class=o>=</span> <span class=n>transactioninsertkeysequence</span><span class=o>.</span><span class=n>nextValue</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=ne>String</span> <span class=n>dbkey</span> <span class=o>=</span> <span class=n>MyWorkload</span><span class=o>.</span><span class=n>buildKeyName</span><span class=p>(</span><span class=n>keynum</span><span class=p>,</span> <span class=n>zeropadding</span><span class=p>,</span> <span class=n>orderedinserts</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>HashMap</span><span class=o>&lt;</span><span class=ne>String</span><span class=p>,</span> <span class=n>ByteIterator</span><span class=o>&gt;</span> <span class=n>values</span> <span class=o>=</span> <span class=n>buildValues</span><span class=p>(</span><span class=n>dbkey</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>db</span><span class=o>.</span><span class=n>insert</span><span class=p>(</span><span class=n>table</span><span class=p>,</span> <span class=n>dbkey</span><span class=p>,</span> <span class=n>values</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=n>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>transactioninsertkeysequence</span><span class=o>.</span><span class=n>acknowledge</span><span class=p>(</span><span class=n>keynum</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Creates</span> <span class=n>a</span> <span class=n>weighted</span> <span class=n>discrete</span> <span class=n>values</span> <span class=n>with</span> <span class=n>database</span> <span class=n>operations</span> <span class=k>for</span> <span class=n>a</span> <span class=n>workload</span> <span class=n>to</span> <span class=n>perform</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Weights</span><span class=o>/</span><span class=n>proportions</span> <span class=n>are</span> <span class=n>read</span> <span class=n>from</span> <span class=n>the</span> <span class=n>properties</span> <span class=n>list</span> <span class=ow>and</span> <span class=n>defaults</span> <span class=n>are</span> <span class=n>used</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>when</span> <span class=n>values</span> <span class=n>are</span> <span class=ow>not</span> <span class=n>configured</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=n>Current</span> <span class=n>operations</span> <span class=n>are</span> <span class=s2>&#34;READ&#34;</span><span class=p>,</span> <span class=s2>&#34;UPDATE&#34;</span><span class=p>,</span> <span class=s2>&#34;INSERT&#34;</span><span class=p>,</span> <span class=s2>&#34;SCAN&#34;</span> <span class=ow>and</span> <span class=s2>&#34;READMODIFYWRITE&#34;</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=err>@</span><span class=n>param</span> <span class=n>p</span> <span class=n>The</span> <span class=n>properties</span> <span class=n>list</span> <span class=n>to</span> <span class=n>pull</span> <span class=n>weights</span> <span class=n>from</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=err>@</span><span class=k>return</span> <span class=n>A</span> <span class=n>generator</span> <span class=n>that</span> <span class=n>can</span> <span class=n>be</span> <span class=n>used</span> <span class=n>to</span> <span class=n>determine</span> <span class=n>the</span> <span class=n>next</span> <span class=n>operation</span> <span class=n>to</span> <span class=n>perform</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*</span> <span class=err>@</span><span class=n>throws</span> <span class=n>IllegalArgumentException</span> <span class=k>if</span> <span class=n>the</span> <span class=n>properties</span> <span class=n>object</span> <span class=n>was</span> <span class=n>null</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>protected</span> <span class=k>static</span> <span class=n>DiscreteGenerator</span> <span class=n>createOperationGenerator</span><span class=p>(</span><span class=n>final</span> <span class=n>Properties</span> <span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>p</span> <span class=o>==</span> <span class=n>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>IllegalArgumentException</span><span class=p>(</span><span class=s2>&#34;Properties object cannot be null&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>double</span> <span class=n>readproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>READ_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>READ_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>double</span> <span class=n>updateproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>UPDATE_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>UPDATE_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>double</span> <span class=n>insertproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>INSERT_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>INSERT_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>double</span> <span class=n>scanproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span><span class=n>SCAN_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>SCAN_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>double</span> <span class=n>readmodifywriteproportion</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=n>parseDouble</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>getProperty</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>READMODIFYWRITE_PROPORTION_PROPERTY</span><span class=p>,</span> <span class=n>READMODIFYWRITE_PROPORTION_PROPERTY_DEFAULT</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>final</span> <span class=n>DiscreteGenerator</span> <span class=n>operationchooser</span> <span class=o>=</span> <span class=n>new</span> <span class=n>DiscreteGenerator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>readproportion</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>operationchooser</span><span class=o>.</span><span class=n>addValue</span><span class=p>(</span><span class=n>readproportion</span><span class=p>,</span> <span class=s2>&#34;READ&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>updateproportion</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>operationchooser</span><span class=o>.</span><span class=n>addValue</span><span class=p>(</span><span class=n>updateproportion</span><span class=p>,</span> <span class=s2>&#34;UPDATE&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>insertproportion</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>operationchooser</span><span class=o>.</span><span class=n>addValue</span><span class=p>(</span><span class=n>insertproportion</span><span class=p>,</span> <span class=s2>&#34;INSERT&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>scanproportion</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>operationchooser</span><span class=o>.</span><span class=n>addValue</span><span class=p>(</span><span class=n>scanproportion</span><span class=p>,</span> <span class=s2>&#34;SCAN&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>readmodifywriteproportion</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>operationchooser</span><span class=o>.</span><span class=n>addValue</span><span class=p>(</span><span class=n>readmodifywriteproportion</span><span class=p>,</span> <span class=s2>&#34;READMODIFYWRITE&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>operationchooser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>将其复制到 YCSB/core/src/main/java/site/ycsb/workloads/目录下。复制命令：sudo cp /home/zufs/share/YCSB/core/src/main/java/site/ycsb/workloads/MyWorkload.java /home/zufs/YCSB/core/src/main/java/site/ycsb/workloads/</p><p>修改 FileGenerator. java，将其放到 YCSB/core/src/main/java/site/ycsb/目录下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>package</span> <span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>generator</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>BufferedReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>FileReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>IOException</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>import</span> <span class=n>java</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>Reader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>/**</span>
</span></span><span class=line><span class=cl> <span class=o>*</span> <span class=n>A</span> <span class=n>generator</span><span class=p>,</span> <span class=n>whose</span> <span class=n>sequence</span> <span class=n>is</span> <span class=n>the</span> <span class=n>lines</span> <span class=n>of</span> <span class=n>a</span> <span class=n>file</span><span class=p>,</span> <span class=n>looping</span> <span class=n>over</span> <span class=n>the</span> <span class=n>file</span> <span class=n>content</span><span class=o>.</span>
</span></span><span class=line><span class=cl> <span class=o>*/</span>
</span></span><span class=line><span class=cl><span class=n>public</span> <span class=k>class</span> <span class=n>FileGenerator</span> <span class=k>extends</span> <span class=n>Generator</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>final</span> <span class=ne>String</span> <span class=n>filename</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=ne>String</span> <span class=n>current</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>BufferedReader</span> <span class=n>reader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>private</span> <span class=n>boolean</span> <span class=n>fileEndReached</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=n>Create</span> <span class=n>a</span> <span class=n>FileGenerator</span> <span class=n>with</span> <span class=n>the</span> <span class=n>given</span> <span class=n>file</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=err>@</span><span class=n>param</span> <span class=n>filename</span> <span class=n>The</span> <span class=n>file</span> <span class=n>to</span> <span class=n>read</span> <span class=n>lines</span> <span class=n>from</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>FileGenerator</span><span class=p>(</span><span class=ne>String</span> <span class=n>filename</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>this</span><span class=o>.</span><span class=n>filename</span> <span class=o>=</span> <span class=n>filename</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>this</span><span class=o>.</span><span class=n>fileEndReached</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>reloadFile</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=n>Return</span> <span class=n>the</span> <span class=n>next</span> <span class=n>string</span> <span class=n>of</span> <span class=n>the</span> <span class=n>sequence</span><span class=p>,</span> <span class=n>ie</span> <span class=n>the</span> <span class=n>next</span> <span class=n>line</span> <span class=n>of</span> <span class=n>the</span> <span class=n>file</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=n>If</span> <span class=n>the</span> <span class=n>end</span> <span class=n>of</span> <span class=n>the</span> <span class=n>file</span> <span class=n>is</span> <span class=n>reached</span><span class=p>,</span> <span class=n>the</span> <span class=n>file</span> <span class=n>is</span> <span class=n>reloaded</span> <span class=ow>and</span> <span class=n>reading</span> <span class=n>starts</span> <span class=n>again</span> <span class=n>from</span> <span class=n>the</span> <span class=n>beginning</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>Override</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>synchronized</span> <span class=ne>String</span> <span class=n>nextValue</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>fileEndReached</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>reloadFile</span><span class=p>();</span> <span class=o>//</span> <span class=n>Reload</span> <span class=n>the</span> <span class=n>file</span> <span class=n>once</span> <span class=n>the</span> <span class=n>end</span> <span class=n>is</span> <span class=n>reached</span>
</span></span><span class=line><span class=cl>        <span class=n>fileEndReached</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=n>current</span> <span class=o>=</span> <span class=n>reader</span><span class=o>.</span><span class=n>readLine</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>current</span> <span class=o>==</span> <span class=n>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>fileEndReached</span> <span class=o>=</span> <span class=bp>true</span><span class=p>;</span> <span class=o>//</span> <span class=n>End</span> <span class=n>of</span> <span class=n>file</span> <span class=n>reached</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>nextValue</span><span class=p>();</span>   <span class=o>//</span> <span class=n>Recurse</span> <span class=n>to</span> <span class=n>reload</span> <span class=n>the</span> <span class=n>file</span> <span class=ow>and</span> <span class=n>get</span> <span class=n>the</span> <span class=n>first</span> <span class=n>line</span> <span class=n>again</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>current</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=n>Return</span> <span class=n>the</span> <span class=n>previous</span> <span class=n>read</span> <span class=n>line</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=err>@</span><span class=n>Override</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=ne>String</span> <span class=n>lastValue</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>current</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>/**</span>
</span></span><span class=line><span class=cl>   <span class=o>*</span> <span class=n>Reopen</span> <span class=n>the</span> <span class=n>file</span> <span class=n>to</span> <span class=n>reuse</span> <span class=n>values</span><span class=o>.</span>
</span></span><span class=line><span class=cl>   <span class=o>*/</span>
</span></span><span class=line><span class=cl>  <span class=n>public</span> <span class=n>synchronized</span> <span class=n>void</span> <span class=n>reloadFile</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span> <span class=p>(</span><span class=n>Reader</span> <span class=n>r</span> <span class=o>=</span> <span class=n>reader</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>System</span><span class=o>.</span><span class=n>err</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;Reload &#34;</span> <span class=o>+</span> <span class=n>filename</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>reader</span> <span class=o>=</span> <span class=n>new</span> <span class=n>BufferedReader</span><span class=p>(</span><span class=n>new</span> <span class=n>FileReader</span><span class=p>(</span><span class=n>filename</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>throw</span> <span class=n>new</span> <span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=编译-ycsb>编译 YCSB</h2><p>安装必要环境</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt install maven openjdk-8-jdk libgflags-dev libsnappy-dev zlib1g-dev libbz2-dev liblz4-dev libzstd-dev
</span></span></code></pre></td></tr></table></div></div><p>配置环境变量</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>export</span> <span class=n>JAVA_HOME</span><span class=o>=</span><span class=s2>&#34;/usr/lib/jvm/java-8-openjdk-amd64&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>如果使用 RocksDB，需要在 <code>./rocksdb/pom.xml</code> 手动添加 htrace 和 hdrhistogram 依赖</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;dependencies&gt;
</span></span><span class=line><span class=cl>    &lt;dependency&gt;
</span></span><span class=line><span class=cl>      &lt;groupId&gt;org.rocksdb&lt;/groupId&gt;
</span></span><span class=line><span class=cl>      &lt;artifactId&gt;rocksdbjni&lt;/artifactId&gt;
</span></span><span class=line><span class=cl>      &lt;version&gt;${rocksdb.version}&lt;/version&gt;
</span></span><span class=line><span class=cl>    &lt;/dependency&gt;
</span></span><span class=line><span class=cl>    &lt;dependency&gt;
</span></span><span class=line><span class=cl>      &lt;groupId&gt;org.apache.htrace&lt;/groupId&gt;
</span></span><span class=line><span class=cl>      &lt;artifactId&gt;htrace-core4&lt;/artifactId&gt;
</span></span><span class=line><span class=cl>      &lt;version&gt;4.1.0-incubating&lt;/version&gt;
</span></span><span class=line><span class=cl>    &lt;/dependency&gt;
</span></span><span class=line><span class=cl>      &lt;dependency&gt;
</span></span><span class=line><span class=cl>      &lt;groupId&gt;org.hdrhistogram&lt;/groupId&gt;
</span></span><span class=line><span class=cl>      &lt;artifactId&gt;HdrHistogram&lt;/artifactId&gt;
</span></span><span class=line><span class=cl>      &lt;version&gt;2.1.4&lt;/version&gt;
</span></span><span class=line><span class=cl>    &lt;/dependency&gt;
</span></span><span class=line><span class=cl>    &lt;dependency&gt;
</span></span><span class=line><span class=cl>      &lt;groupId&gt;site.ycsb&lt;/groupId&gt;
</span></span><span class=line><span class=cl>      &lt;artifactId&gt;core&lt;/artifactId&gt;
</span></span><span class=line><span class=cl>      &lt;version&gt;${project.version}&lt;/version&gt;
</span></span><span class=line><span class=cl>      &lt;scope&gt;provided&lt;/scope&gt;
</span></span><span class=line><span class=cl>    &lt;/dependency&gt;
</span></span></code></pre></td></tr></table></div></div><p>切换到 YCSB 目录下编译</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mvn -pl site.ycsb:rocksdb-binding -am clean package
</span></span></code></pre></td></tr></table></div></div><p>测试时修改 workload 文件，添加一个参数 datafile 是数据集负载路径。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>recordcount</span><span class=o>=</span><span class=mi>5000</span>
</span></span><span class=line><span class=cl><span class=n>operationcount</span><span class=o>=</span><span class=mi>100000</span>
</span></span><span class=line><span class=cl><span class=n>workload</span><span class=o>=</span><span class=n>site</span><span class=o>.</span><span class=n>ycsb</span><span class=o>.</span><span class=n>workloads</span><span class=o>.</span><span class=n>MyWorkload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>readallfields</span><span class=o>=</span><span class=bp>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>datafile</span><span class=o>=/</span><span class=n>home</span><span class=o>/</span><span class=n>zufs</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>YCSB_dataset</span><span class=o>/</span><span class=n>dataset</span><span class=o>/</span><span class=n>nci</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>readproportion</span><span class=o>=</span><span class=mf>0.5</span>
</span></span><span class=line><span class=cl><span class=n>updateproportion</span><span class=o>=</span><span class=mf>0.5</span>
</span></span><span class=line><span class=cl><span class=n>scanproportion</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>insertproportion</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>requestdistribution</span><span class=o>=</span><span class=n>zipfian</span>
</span></span></code></pre></td></tr></table></div></div><p>测试命令：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=o>./</span><span class=n>bin</span><span class=o>/</span><span class=n>ycsb</span><span class=o>.</span><span class=n>sh</span> <span class=nb>load</span> <span class=n>rocksdb</span> <span class=o>-</span><span class=n>s</span> <span class=o>-</span><span class=n>P</span> <span class=n>workloads</span><span class=o>/</span><span class=n>fileworkloada</span> <span class=o>-</span><span class=n>p</span> <span class=n>rocksdb</span><span class=o>.</span><span class=n>dir</span><span class=o>=/</span><span class=n>mnt</span><span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>ycsb</span><span class=o>-</span><span class=n>rocksdb</span><span class=o>-</span><span class=n>data</span> <span class=o>-</span><span class=n>threads</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=o>./</span><span class=n>bin</span><span class=o>/</span><span class=n>ycsb</span><span class=o>.</span><span class=n>sh</span> <span class=n>run</span> <span class=n>rocksdb</span> <span class=o>-</span><span class=n>s</span> <span class=o>-</span><span class=n>P</span> <span class=n>workloads</span><span class=o>/</span><span class=n>fileworkloada</span> <span class=o>-</span><span class=n>p</span> <span class=n>rocksdb</span><span class=o>.</span><span class=n>dir</span><span class=o>=/</span><span class=n>mnt</span><span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>ycsb</span><span class=o>-</span><span class=n>rocksdb</span><span class=o>-</span><span class=n>data</span> <span class=o>-</span><span class=n>threads</span> <span class=mi>64</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=参考资料>参考资料</h2><p><a class=link href=https://blog.ywang-wnlo.xyz/posts/4bc1e607/ target=_blank rel=noopener>https://blog.ywang-wnlo.xyz/posts/4bc1e607/</a></p><p><a class=link href=https://github.com/brianfrankcooper/YCSB/wiki/Implementing-New-Workloads target=_blank rel=noopener>https://github.com/brianfrankcooper/YCSB/wiki/Implementing-New-Workloads</a></p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/>操作系统</a>
<a href=/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/>数据库</a>
<a href=/tags/ycsb/>YCSB</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on Dec 30, 2024 00:00 UTC</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/f2fs_lfs/><div class=article-details><h2 class=article-title>F2FS的优点以及与LFS的区别</h2></div></a></article><article><a href=/p/crash_recovery_f2fs_linux3.8/><div class=article-details><h2 class=article-title>Linux 3.8中的F2FS崩溃恢复</h2></div></a></article><article><a href=/p/what_is_memory/><div class=article-details><h2 class=article-title>什么是内存</h2></div></a></article><article><a href=/p/use_f2fs_filesystem/><div class=article-details><h2 class=article-title>使用F2FS文件系统</h2></div></a></article><article><a href=/p/concepts_on_f2fs_filesystem/><div class=article-details><h2 class=article-title>F2FS 文件系统相关概念</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=realcedriccheng/utterances issue-term=pathname label=✨💬✨ crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2024 -
2025 The Orange Flavored Whisper</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>